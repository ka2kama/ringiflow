---
paths:
  - "**/*.md"
---

# ドキュメント規約

全ての Markdown ファイルに適用する。

## 共通ルール

| 項目 | ルール |
|------|--------|
| 図表 | Mermaid 記法を使用。ASCII art は原則禁止（ピラミッド等 Mermaid で表現不可能な図のみ例外） |

### Mermaid ノードラベル

図の種類によって構文が異なる:

| 図の種類 | 構文 | 例 |
|---------|------|-----|
| flowchart | `ID["ラベル"]` | `Browser["ブラウザ"]` |
| sequenceDiagram | `participant ID as ラベル` | `participant Core as Core Service` |

補足:
- sequenceDiagram の `as` 構文は、`as` 以降全体がラベルになるため空白を含んでもクォート不要
- sequenceDiagram で `ID["ラベル"]` 形式を使うと participant が重複表示される

## 太字・斜体の使用

太字は最小限に留める。以下の基準に従う。

使ってよい場面:
- 警告・禁止事項で、見落としが致命的な箇所（例: `**禁止:**`）
- インラインの小見出し（例: `**Draft PR の目的:**`）

使わない場面:
- 番号付きリストの項目名（番号だけで十分識別できる）
- 定型ラベル（「注意:」「重要:」「フォーマット:」「参考:」など）
- 文全体や長いフレーズ（読みにくい）

判断基準: 太字を外しても意味が伝わるなら、太字は不要。

## ファイル命名

| 対象 | ルール |
|------|--------|
| `docs/**`（連番体系） | 連番プレフィックス: `00_`, `01_`, ... |
| `docs/**`（コレクション型） | 各ディレクトリの README.md に記載された命名規則に従う |
| `prompts/runs/**` | `YYYY-MM-DD_HHMM_<トピック>.md` |
| `prompts/improvements/**` | `YYYY-MM-DD_HHMM_<トピック>.md` |
| その他 | 自由（ただし kebab-case 推奨） |

### エントリファイル

`docs/` 配下のディレクトリには、ディレクトリの体系に応じたエントリファイルを配置する。

| ディレクトリの体系 | エントリファイル | 判断基準 |
|-----------------|---------------|---------|
| 連番体系 | `00_はじめに.md` | ファイル群が `00_`, `01_`, ... で連番されている |
| コレクション型 | `README.md` | サブディレクトリや独立した記事を管理、連番なし |

連番体系の例: 01_要件定義書、04_手順書
コレクション型の例: 05_ADR、06_ナレッジベース、07_実装解説

エントリファイルの役割:
- ディレクトリの目的と構成の説明
- 読む順序やナビゲーションの提供（連番体系の場合）
- カテゴリ一覧や書き方の説明（コレクション型の場合）

注: 02_基本設計書、03_詳細設計書は `00_` スロットが既存ファイルに占有されており、#323（リナンバリング）で対応予定。08_テストはディレクトリ構造が未成熟のため保留。

### 命名規則のあるファイル作成時の照合

命名規則が定められたディレクトリにファイルを作成する際は、以下のプロセスで照合する:

1. 該当ディレクトリの命名規則（README.md 等）を確認する
2. テンプレートの各パートを埋めてファイル名を組み立てる
3. 組み立てたファイル名がテンプレートと一致するか照合する
4. ファイルを作成する

例（`prompts/improvements/`）:
```
テンプレート: YYYY-MM-DD_HHMM_<トピック>.md
→ 2026-01-29_1304_E2E視点の完了基準欠如.md
→ 照合: YYYY-MM-DD ✅  HHMM ✅  トピック ✅
```

改善の経緯: [命名規則を読んだが従わなかった](../../prompts/improvements/2026-01/2026-01-29_1307_命名規則を読んだが従わなかった.md)

## 外国語名の表記

発音が自明でない固有名詞や、展開形が分かりにくい略語には、初出時に読みや展開形を併記することを**推奨**する。

併記が望ましい例:

| パターン | 例 |
|---------|-----|
| 発音が自明でない名前 | Vite（ヴィート）、Elm（エルム）、Cargo（カーゴ） |
| 展開形が分かりにくい略語 | BFF（Backend for Frontend） |

注意: これは推奨であり、併記がなくてもレビューでブロックしない。
「広く知られている」かどうかの判断は主観的なため、迷った場合は併記しても良いし、しなくても良い。

## ドキュメント生成時の自己チェック

AI がドキュメント（Issue、PR 本文、設計書、改善記録、セッションログ等）を生成する際、以下を確認する。

| # | チェック項目 | 確認内容 |
|---|------------|---------|
| 1 | コンテキスト独立性 | 会話の文脈を知らない読者が読んでも意味が通るか |
| 2 | 主観排除 | 主観的な評価（「良い」「素晴らしい」「筋が通っている」等）が混入していないか |
| 3 | サニタイズ | ユーザーの発言が技術的内容に要約されているか（直接引用を避ける） |
| 4 | 文体整合 | 対象ファイルの文体規約に従っているか（ルールファイルは簡潔なルール文体、語りかけ調の排除） |
| 5 | チェックボックス検証 | チェックボックスは検証完了後のみチェックする。検証せずにチェックしてはならない |
| 6 | 命名規則照合 | 命名規則が定められたディレクトリでは、テンプレートの各パートを埋めてファイル名を組み立て、実際のファイル名と照合する |

改善の経緯:
- [会話コンテキストのドキュメント混入](../../prompts/improvements/2026-02/2026-02-06_2330_会話コンテキストのドキュメント混入.md)
- [改善記録にユーザー発言を直接引用した](../../prompts/improvements/2026-02/2026-02-09_2122_改善記録にユーザー発言を直接引用した.md)
- [ルールファイル追記時の文体規約違反](../../prompts/improvements/2026-02/2026-02-09_2117_ルールファイル追記時の文体規約違反.md)
- [Test plan チェックボックスの形骸化](../../prompts/improvements/2026-02/2026-02-14_2130_Test-planチェックボックスの形骸化.md)

## 設計書の実装状態マーカー

設計書（`docs/02_基本設計書/`、`docs/03_詳細設計書/`）において、未実装または部分的に実装済みのセクションには blockquote 形式で実装状態を明示する。

### 基本ルール

- マーカーなし = 実装済み（デフォルト）
- 未実装・部分的にのみマーカーを付与する（例外マーキング方式）
- Phase 番号は [実装ロードマップ](../../docs/03_詳細設計書/00_実装ロードマップ.md) に準拠する

### マーカーの書式

```markdown
> **実装状態**: 未実装（Phase N で実装予定）

> **実装状態**: 部分的に実装済み。〇〇は実装済み。△△は Phase N で対応予定。
```

### マーカーの配置

- セクション見出しの直後（本文の前）に配置する
- 文書の大部分が未実装の場合は、冒頭にも文書レベルの注記を追加する

### マーカーの更新タイミング

- 該当機能を実装したとき、マーカーを削除する
- 部分的に実装が進んだとき、マーカーの内容を更新する

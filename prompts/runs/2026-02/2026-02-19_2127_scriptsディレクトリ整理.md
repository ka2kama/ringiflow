# scripts ディレクトリ整理

対応 Issue: #676
対応 PR: #677

## 概要

`scripts/` 配下にフラットに配置されていた 19 個のシェルスクリプトを、機能別の 5 サブディレクトリ（`check/`, `test/`, `worktree/`, `env/`, `tools/`）に整理した。ディレクトリがプレフィックスの役割を担うため、冗長なプレフィックスも除去した。

## 実施内容

### Phase 1: ファイル移動

`git mv` で 19 スクリプトをサブディレクトリへ移動・リネーム。

| サブディレクトリ | 個数 | 内容 |
|-----------------|------|------|
| `check/` | 7 | コード・ドキュメント品質チェック |
| `test/` | 3 | テスト実行 |
| `worktree/` | 4 | worktree・ブランチ管理 |
| `env/` | 2 | 環境変数ファイル管理 |
| `tools/` | 3 | 独立ツール（DB スキーマダンプ、MCP、デプロイ） |

### Phase 2: スクリプト内部のパス修正

- `PROJECT_ROOT` 計算の修正: `scripts/` → `scripts/<subdir>/` への移動により、`dirname` を 1 段追加（8 ファイル）
- スクリプト間の相互参照パスの更新（4 箇所）
- 冒頭コメントの Usage 行を新パスに更新

### Phase 3: justfile のパス更新

17 箇所のスクリプトパスを新パスに一括更新。

### Phase 4: CI・設定ファイル・ドキュメントのパス更新

- CI ワークフロー: 3 ファイル
- `.mcp.json`: 1 箇所
- ドキュメント: 壊れた相対リンクとインライン参照を 8 ファイルで修正

### Phase 5: 動作検証

`just check` 通過を確認。

## 判断ログ

- 計画では `mcp-postgres.sh` のみ `PROJECT_ROOT` 修正が必要としていたが、実装時に Grep で確認したところ、サブディレクトリに移動した全 8 ファイルで同じ修正が必要だった。計画の調査不足だが、実装前の確認（pre-implementation verification）で検出・対応した
- 歴史的記録（`prompts/runs/`, `prompts/plans/`（既存）, `process/improvements/`）は作成時点のスナップショットとして修正せず保全した

## 成果物

- コミット: `bc7fe03` — #676 Organize scripts into functional subdirectories
- 変更ファイル: 33 ファイル（スクリプト 19 + justfile + CI 3 + .mcp.json + ドキュメント 8 + playwright.config.ts）
- 計画ファイル: `prompts/plans/agile-hugging-ritchie.md`（リネーム予定）

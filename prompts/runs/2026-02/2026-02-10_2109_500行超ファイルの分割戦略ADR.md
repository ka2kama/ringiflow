# 500行超ファイルの分割戦略 ADR

## 概要

Issue #290（500行超ファイルのリファクタリング）に着手し、ADR-043 として分割戦略を文書化した。探索の結果、Issue 記載の Backend 5ファイル中 3つは既に別 ADR（039, 041）で完了済みであり、Issue の前提が大きく変化していることが判明。残りファイルの責務分析と、Issue 未記載の閾値超過ファイルの発見・判定を行った。

## 実施内容

1. Issue #290 の精査（問題解決フレームワーク適用）
2. Backend 全対象ファイルの現在行数を調査（wc -l）
3. プロダクションコード vs テストコードの比率分析（`#[cfg(test)]` の位置特定）
4. Frontend 全対象ファイルの構造分析（TEA パターン、責務の境界）
5. ADR-043 作成（分割対象 3ファイル、例外許容 4ファイルの判定）
6. Issue #290 本文を現状に合わせて更新

## 判断ログ

- 例外許容の基準として「prod < 500 + 高凝集」を確立した。task.rs（ADR-041 で既に判断済み）と同じパターンを auth.rs、value_objects.rs に適用
- handler/workflow.rs の分割軸は CQRS を選択。エンティティ別分割も検討したが、usecase 層（ADR-039）との構造的対応を優先した
- ADR-041 で「要検討」としていた New.elm について、改めて責務分析を実施。複合責務（承認者選択 UI）の混在を確認し、Component 抽出を決定
- Main.elm は TEA + Nested TEA ルーターの帰結として例外許容を確定

## 成果物

### コミット

- `#290 Add ADR-043: Oversized file splitting strategy`

### 作成・更新ファイル

| ファイル | 操作 |
|---------|------|
| `docs/05_ADR/043_500行超ファイルの分割戦略.md` | 新規作成 |
| Issue #290 本文 | `gh issue edit` で更新 |

### PR

- [#384](https://github.com/ka2kama/ringiflow/pull/384) Add ADR-043: Oversized file splitting strategy（Draft）

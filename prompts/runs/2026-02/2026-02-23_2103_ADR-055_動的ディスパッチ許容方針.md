# ADR-055: バックエンドにおける動的ディスパッチ許容方針

## 概要

バックエンドにおける動的ディスパッチ（`dyn Trait`）の許容方針を ADR-055 として明文化し、AI エージェント向けのルールファイルに強制ルールを追加した。

## 実施内容

1. 現状の動的ディスパッチ使用状況を調査（42 ファイルで `dyn` 使用、`Arc<dyn>` 40 ファイル、`Box<dyn>` 27 ファイル）
2. 既存 ADR（ADR-041, ADR-051）での動的ディスパッチ関連の判断を確認
3. ADR-055 を作成: 3 つの選択肢（静的優先 / 動的許容 / 完全動的）を比較し、「動的ディスパッチ許容（型安全性を条件に）」を採用
4. `.claude/rules/rust.md` に動的ディスパッチのルールセクションと AI エージェントへの指示を追加

## 判断ログ

- ADR-055 の選択肢設計: Web アプリケーションにおける vtable lookup コスト（数ナノ秒）と I/O レイテンシ（数ミリ秒〜数十ミリ秒）の差を根拠に、パフォーマンスをデメリットから除外
- ルールファイルへの配置: `.claude/rules/rust.md` の「品質基準」セクション内に「動的ディスパッチ」サブセクションを追加。ADR は判断の記録、ルールファイルは AI への強制という役割分離

## 成果物

- `docs/70_ADR/055_バックエンドにおける動的ディスパッチ許容方針.md`（新規）
- `.claude/rules/rust.md`（動的ディスパッチセクション追加、AI エージェント指示に項目追加）
- PR: #806

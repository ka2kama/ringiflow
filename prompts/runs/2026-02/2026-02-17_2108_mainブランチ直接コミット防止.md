# main ブランチ直接コミット防止

## 概要

Issue #618: AI エージェントがドキュメントのみの変更時に main ブランチへの直接コミットを提案する問題への対策。ソフトコントロール（CLAUDE.md の禁止事項明確化）とハードコントロール（lefthook pre-commit フック）の両面で対応した。

## 実施内容

1. CLAUDE.md の禁止事項に「変更の種類によらず例外なし」の補足を追加
2. lefthook の pre-commit に `no-main-commit` コマンドを追加（main ブランチでのコミットを拒否）

## 判断ログ

- lefthook フックをインラインスクリプトで実装した（`no-yml-extension` と同様のシンプルなチェックであり、`.lefthook/` にファイルを分離する複雑さが不要）

## 成果物

コミット:
- `#618 Prevent direct commits to main branch`
- `#618 Add implementation plan for main branch protection`

変更ファイル:
- `CLAUDE.md`: 禁止事項の補足追加
- `lefthook.yaml`: `no-main-commit` pre-commit コマンド追加
- `prompts/plans/replicated-yawning-hearth.md`: 実装計画

# テストピラミッドナレッジベース追加

Issue: #967
PR: #968

## 概要

テストピラミッドの概念整理をナレッジベースに追加した。ringiflow の 4 テスト手法（ユニット / ハンドラ / API / E2E）と 3 層ピラミッド（ユニット / 統合 / E2E）の対応関係を明文化し、Testing Trophy との比較を記載した。

## 実施内容

1. `docs/06_ナレッジベース/methodology/テストピラミッド.md` を新規作成
   - 3 層ピラミッドの定義（スコープ別分類）
   - ringiflow の 4 テスト手法と 3 層の対応表
   - 統合テスト層内の位置づけ（API > ハンドラ > リポジトリ）
   - Testing Trophy との比較と ringiflow での位置づけ
   - 概念層と実践層の関係図
2. 既存ドキュメントとの相互参照を整備
   - `dev-flow-tdd.md` → ナレッジベースへのリンク追加
   - `e2e-test.md` → ナレッジベースへのリンク追加
   - ナレッジベース → CORE-12、基本設計書、ADR-032/036 等への参照追加
3. `tests/api/README.md` の独自ピラミッド図を整理
   - ASCII ピラミッド図をナレッジベースへの参照 + 表に置き換え

## 判断ログ

- テストピラミッドの独自図が 6 箇所に散在していたが、要件定義書と基本設計書の図は仕様としてそのまま残し、実装解説は PR スナップショットとして変更せず、`tests/api/README.md` の説明用コピーのみナレッジベース参照に置き換えた

## 成果物

### コミット

| ハッシュ | 内容 |
|---------|------|
| `cbfadc6d` | テストピラミッドナレッジベースドキュメント追加 |
| `5c8c5969` | 相互参照リンクの追加 |
| `dcde0994` | API テスト README のピラミッド図をナレッジベース参照に置換 |

### 作成・更新ファイル

| ファイル | 変更 |
|---------|------|
| `docs/06_ナレッジベース/methodology/テストピラミッド.md` | 新規作成 |
| `.claude/rules/dev-flow-tdd.md` | リンク追加 |
| `.claude/rules/e2e-test.md` | リンク追加 |
| `tests/api/README.md` | 独自図 → ナレッジベース参照に置換 |

## 議論の経緯

- 初版作成後、ユーザーから「他にもピラミッドがあるドキュメントがある」との指摘を受け、プロジェクト全体を Grep で調査。6 箇所の独自図を発見し、相互参照リンクを追加
- 独自図の整理方針について、ユーザーから「徐々に整理したものなので不整合は仕方ない。気づいたタイミングで直す」との方針を確認。今回は `tests/api/README.md` のみ整理

# ユーザーフォーム role_name フィールド不一致修正

## 概要

デモ環境のユーザー作成・編集フォームでデシリアライズエラーが発生していたバグを修正した。フロントエンドが送信する JSON フィールド名とバックエンド API の期待するフィールド名の不一致が原因。暫定修正を適用し、本格的な API 設計修正は Issue 化した。

## 実施内容

### バグの特定

デモ環境でユーザー作成時に以下のエラーが発生:

```
Failed to deserialize the JSON body into the target type: missing field `role_name` at line 1 column 102
```

フロントエンド（Elm）とバックエンド（Rust/axum）の調査により、2つの不一致を発見:

1. JSON フィールド名: フロントが `"role_id"` → バックエンドは `"role_name"` を期待
2. フィールド値: フロントが `role.id`（UUID）→ バックエンドは `role.name`（ロール名文字列）を期待

同じ問題が `Page/User/New.elm` と `Page/User/Edit.elm` の両方に存在。

### 暫定修正の適用

フロントエンドを現行バックエンド API に合わせる最小修正を適用:
- JSON フィールド名を `"role_id"` → `"role_name"` に変更
- `<select>` の value を `role.id` → `role.name` に変更

### Issue 作成（#769）

バックエンド API を `role_id`（UUID）ベースに変更する本格対応を Issue 化。変更対象はリポジトリ層・Core Service・BFF・フロントエンドの全レイヤーに及ぶ。

## 判断ログ

- バックエンド API を `role_name` → `role_id` に変更すべきと判断。理由: DB の `roles.name` に UNIQUE 制約がない、REST API の慣例として ID 参照が標準的、フロントエンドは既にロール ID を保持している
- 変更範囲が広い（10ファイル以上）ため、暫定修正と本格修正を分離する方針を採用

## 議論の経緯

- 当初はフロントエンドのフィールド名修正 + `selectedRoleId` → `selectedRoleName` のリネームで対応を進めた
- ユーザーから「バックエンドが受け取るべきは ID では？」との指摘があり、DB スキーマ・リポジトリ・ユースケースを調査
- `roles` テーブルの `name` に UNIQUE 制約がないことが判明し、`role_id` ベースへの変更が適切と合意
- 変更範囲の広さから、暫定修正 + Issue 化の方針で合意

## 成果物

- コミット: `#769 Fix user create/edit form role_name field mismatch`
- PR: #770
- Issue: #769（バックエンド API の `role_id` 化）

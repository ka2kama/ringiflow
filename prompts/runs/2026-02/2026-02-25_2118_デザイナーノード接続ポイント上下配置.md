# デザイナーノード接続ポイント上下配置

Issue: #913

## 概要

ワークフローデザイナーのノード接続ポイント（ハンドル）を左右配置（水平）から上下配置（垂直）に変更した。オートレイアウトの縦方向フローに合わせて、遷移線が上→下に自然に流れるようにした。

## 実施内容

### Phase 1: ポート位置関数の変更（TDD）

- `stepOutputPortPosition`: 右端中央 `(x + width, y + height/2)` → 下端中央 `(x + width/2, y + height)`
- `stepInputPortPosition`: 左端中央 `(x, y + height/2)` → 上端中央 `(x + width/2, y)`
- テスト期待値を更新し、Red → Green で実装

### Phase 2: SVG ポート描画位置の変更

- 出力ポートの SVG circle: `cx=width, cy=height/2` → `cx=width/2, cy=height`
- 入力ポートの SVG circle: `cx=0, cy=height/2` → `cx=width/2, cy=0`

### Phase 3: ベジェ曲線の制御点変更

- `viewTransitionLine` と `viewPreviewLine` の制御点を水平オフセット（dx）→ 垂直オフセット（dy）に変更
- SVG cubic Bézier: `C (startX+dx) startY, (endX-dx) endY` → `C startX (startY+dy), endX (endY-dy)`

### その他

- `/start` スキル実行後に設計フェーズに自動遷移しない問題を発見。応答判定ルール（#844）とスキル内指示の競合が原因。改善記録を作成

## 判断ログ

- 特筆すべき判断なし（Issue の仕様通りの座標変更のみ）

## 成果物

### コミット

- `#913 WIP: Change designer node connection points to vertical layout`（空コミット、Draft PR 用）
- `#913 Change designer node connection points to vertical layout`（実装）
- `#913 Add improvement record and plan file for #913`

### 作成・更新ファイル

- `frontend/src/Data/DesignerCanvas.elm` — ポート位置関数（2関数）
- `frontend/src/Page/WorkflowDefinition/Designer.elm` — SVG 描画 + ベジェ曲線制御点
- `frontend/tests/Data/DesignerCanvasTest.elm` — テスト期待値
- `process/improvements/2026-02/2026-02-25_2118_応答判定ルールがスキル内指示と競合する.md`
- `prompts/plans/913_designer-vertical-port-layout.md`

## 議論の経緯

- `/start` スキル実行後、Step 6 で停止し設計フェーズに自動遷移しない問題が発生した。2026-02-23 の #844 で追加された「ユーザー発言の応答判定」ルールがスキル内指示を抑制していることが原因と特定。改善記録を作成した

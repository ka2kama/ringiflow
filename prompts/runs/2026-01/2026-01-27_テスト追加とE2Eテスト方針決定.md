# 2026-01-27 テスト追加と E2E テスト方針決定

## 概要

フロントエンドの Data モジュールにデコーダーテストを追加し、E2E テストの技術選定を行った。

## 実施内容

### 1. デコーダーテストの追加

Phase 2（申請フォーム UI）のテストカバレッジ向上のため、Data モジュールのデコーダーテストを追加。

**追加したテストファイル**:

| ファイル | テスト数 | 内容 |
|----------|----------|------|
| `tests/Data/WorkflowDefinitionTest.elm` | 7 | decoder, listDecoder |
| `tests/Data/WorkflowInstanceTest.elm` | 24 | Status 変換, decoder, listDecoder |

**テスト設計のポイント**:
- オプショナルフィールドの3パターン（値あり、null、省略）をカバー
- 双方向変換の検証（`statusToString` ↔ `statusFromString`）
- 不正値のエラーハンドリング

**結果**: フロントエンドテスト 59 件がすべてパス

### 2. E2E テストの技術選定

当初 elm-program-test を検討したが、調査の結果 Playwright を採用することに決定。

**elm-program-test の調査結果**:

| 指標 | 値 | 評価 |
|------|-----|------|
| GitHub Stars | 94 | Elm エコシステムとしては中程度 |
| Open Issues | 46 | 放置気味 |
| 最終更新 | 2024-05-18 | 約1年半前 |
| 作者 | avh4 | elm-format の作者（信頼性高） |

**見送りの理由**:
1. メンテナンス状況に懸念（1年半更新なし、Issue 46件）
2. Elm エコシステム依存（学習の汎用性が低い）
3. テスト範囲が Elm の view/update のみ

**Playwright を選定した理由**:
1. Microsoft が活発にメンテナンス
2. 業界標準で他プロジェクトでも活きる知識
3. フロントエンド + バックエンドの統合テストが可能

## Issue 管理

- クローズ: [#127 elm-program-test を導入して統合テストを追加する](https://github.com/ka2kama/ringiflow/issues/127)
- 新規作成: [#128 Playwright で E2E テストを導入する](https://github.com/ka2kama/ringiflow/issues/128)（優先度: 低）

## コミット

- `66cc5e7` #115 Data モジュールのデコーダーテストを追加

## 学び

### 技術選定の判断基準

「機能の優劣」だけでなく「メンテナンス状況」と「学習の汎用性」を重視する。
特に小さなエコシステム（Elm）では、コミュニティの活発さがライブラリの寿命に直結する。

### テストカバレッジの現状

| レイヤー | テスト数 | カバレッジ |
|----------|----------|------------|
| Backend (Rust) | 120 | ドメイン、ユースケース、ハンドラー |
| Frontend (Elm) | 59 | デコーダー、バリデーション |

ユニットテストは充実してきた。E2E テストは優先度を下げ、必要になったタイミングで Playwright を導入する。

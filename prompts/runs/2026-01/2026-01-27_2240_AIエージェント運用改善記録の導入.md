# 2026-01-27 AI エージェント運用改善記録の導入

## 概要

AI エージェント運用上の問題と対策を記録する仕組み `prompts/improvements/` を導入し、CLAUDE.md の Issue 駆動開発セクションを改善した。

## 背景

Issue #115 の Phase 3 実装において、AI エージェントが Issue 駆動開発の手順書を読まずにコード実装を開始しようとする問題が発生した。

CLAUDE.md に「機能実装を開始する際は手順書のフローに従う」と記載されていたが、AI エージェントがこの指示を実行しなかった。

## 実施内容

### 1. 問題の分析

CLAUDE.md の Issue 駆動開発セクションの問題点を特定:

| 問題 | 詳細 |
|------|------|
| 指示の位置 | セクション末尾の箇条書きに埋もれている |
| トリガーが不明確 | 「機能実装を開始する際」が何を指すか曖昧 |
| 行動が不明確 | 「フローに従う」ではなく「手順書を読む」と書くべき |

### 2. 顛末書の保存先検討

顛末書をどこに保存するか議論:

| 候補 | 評価 |
|------|------|
| `prompts/runs/` | セッションログ用。顛末書とは性質が異なる |
| `docs/05_ADR/` | アーキテクチャ上の意思決定用。顛末書ではない |
| `prompts/incidents/` | 「インシデント」は本番障害のイメージが強い |
| `prompts/improvements/` | 採用。問題と対策を記録し改善につなげる目的を表す |

### 3. CLAUDE.md の改善

Issue 駆動開発セクションを改善:

- セクション冒頭に必須事項を配置
- 「コードを書く前に手順書を読む」を明確化
- 禁止事項を明示
- ドキュメント体系に改善記録を追加

## 成果物

| ファイル | 内容 |
|---------|------|
| `prompts/improvements/README.md` | 改善記録の説明 |
| `prompts/improvements/2026-01-27_Issue駆動開発フロー未遵守.md` | 顛末書 |
| `CLAUDE.md` | Issue 駆動開発セクション改善、ドキュメント体系更新 |

## 学び

### ドキュメントの配置

- 新しい種類のドキュメントを作成する際は、既存のフォルダ構成に縛られず、目的に合った場所を検討する
- 「顛末書」「インシデント」「改善記録」など、言葉の選択も目的を表すものにする

### AI エージェントへの指示

- セクション末尾の箇条書きは見落とされやすい
- 最重要な指示はセクション冒頭に配置する
- トリガー（いつ）と行動（何をする）を明確にする
- 禁止事項を明示することで境界を明確にする

## 次のステップ

- Issue #115 Phase 3 の実装を手順書に従って進める

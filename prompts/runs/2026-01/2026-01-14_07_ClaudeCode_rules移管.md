# 2026-01-14_07: Claude Code rules 移管

## 概要

CLAUDE.md の内容を `.claude/rules/` に移管すべきか検討し、ドキュメント規約を移管した。
また、Claude Code の rules 機能について技術ノートを作成した。

## 背景と目的

- CLAUDE.md が肥大化する前に、適切な分割戦略を検討したい
- Claude Code の `.claude/rules/` 機能を活用し、ファイルタイプ別のルール適用を実現したい

## 実施内容

### 1. rules 機能の調査

Claude Code の `.claude/rules/` 機能について調査:

- `paths` フィールドで特定のファイルパターンにのみルールを適用可能
- YAML フロントマターで Glob パターンを指定
- paths 省略時は全ファイルに適用（CLAUDE.md と同じ挙動）

### 2. 移管判断

CLAUDE.md の各セクションを分析し、移管すべきものを判断:

| セクション | 判断 | 理由 |
|-----------|------|------|
| ドキュメント規約 | 移管 | `docs/**/*.md` 編集時のみ必要 |
| 言語 / 概要 / 理念 | 維持 | 全ての作業に適用 |
| 暗黙知ゼロ | 維持 | プロジェクト構造理解に必要 |
| 学習支援 | 維持 | 全ての作業に適用 |

### 3. ドキュメント規約の移管

`.claude/rules/docs.md` を作成し、CLAUDE.md のドキュメント規約セクションは参照リンクに簡略化。

### 4. 技術ノート作成

`docs/05_技術ノート/ClaudeCode_rules.md` を作成:

- CLAUDE.md との違い
- paths 指定と Glob パターン
- 使い分けガイドライン

## 成果物

| ファイル | 内容 |
|---------|------|
| `.claude/rules/docs.md` | ドキュメント規約（条件付きルール） |
| `docs/05_技術ノート/ClaudeCode_rules.md` | rules 機能の技術ノート |
| `CLAUDE.md` | ドキュメント規約を参照リンクに簡略化 |

## 設計判断と実装解説

### 移管範囲を最小限にした理由

1. 「暗黙知ゼロ」の理念との整合性
   - ルールを分散させすぎると全体像の把握が難しくなる
   - 現時点では CLAUDE.md のサイズは管理可能な範囲

2. 明確なスコープを持つルールのみ移管
   - ドキュメント規約は `docs/**/*.md` にのみ適用
   - コード編集時には無関係なルール

3. 段階的な分割戦略
   - プロジェクト成長に応じて必要になったら追加分割
   - 現段階での過度な構造化を避ける

## ユーザープロンプト（抜粋）

> CLAUDE.md の内容、あるいは各種ドキュメントの記載のうち、`.claude/rules/` に移管した方がいいものはありますか？

> rules について技術ノートにまとめてください。

## 学んだこと

- Claude Code の rules 機能は `paths` フィールドで条件付き適用が可能
- 全体に適用されるルールは CLAUDE.md に、ファイルタイプ固有のルールは rules/ に分けるのが適切
- 過度な分割は「暗黙知ゼロ」の理念と矛盾するため、必要最小限に留める
- 技術ノートに「現在の構成」を書くとメンテナンスコストが増えるため避ける

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2026-01-14 | 初版作成 |

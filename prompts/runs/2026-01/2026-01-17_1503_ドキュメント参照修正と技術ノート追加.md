# 2026-01-17_06: ドキュメント参照修正と技術ノート追加

## 概要

PR #41 で実施したドキュメント構造再編に伴う参照パスの修正漏れを解消し、コア要件で使用されている難解な用語を解説する技術ノートを追加した。

## 背景と目的

PR #41 でドキュメント構造を再編成した際、以下の問題が残っていた:

1. 古いパス参照（`04_ADR` → `70_ADR`、`05_技術ノート` → `06_技術ノート` 等）
2. コア要件内のセクション番号の不整合
3. データベース設計の ER 図が Mermaid パースエラー
4. SCIM プロビジョニング等のエンタープライズ用語の解説不足

## 実施内容

### 1. ドキュメント参照パスの修正

| 修正パターン | ファイル数 |
|-------------|-----------|
| `04_ADR` → `70_ADR` | 8 |
| `05_技術ノート` → `06_技術ノート` | 6 |
| `02_設計書` → `30_基本設計書`/`40_詳細設計書` | 4 |
| `_MVP.md` → 現在のファイル名 | 2 |

### 2. コア要件の修正

- 文書構成セクションを現行の 3 ファイル構成に更新
- セクション 5.9 内の古い見出し参照（`4.x` → `5.x`）を修正
- CORE-02〜12 のサブセクション番号を修正

### 3. Mermaid 構文の修正

- データベース設計の ER 図: スペースを含む関係ラベルをクォートで囲む
- 技術ノートの ASCII art を Mermaid に変換

### 4. 技術ノートの追加

`docs/06_技術ノート/エンタープライズ認証とID管理.md` を作成:

- SSO（シングルサインオン）の概念と必要性
- IdP（Identity Provider）と SP の役割
- SAML 2.0 と OIDC の比較
- SCIM プロビジョニングの詳細解説
- MFA（多要素認証）と TOTP
- RBAC と ABAC の違い

## 成果物

### 修正ファイル（19 ファイル）

- `docs/10_要件定義書/01_コア要件.md`
- `docs/30_基本設計書/00_アーキテクチャ概要.md`
- `docs/30_基本設計書/02_プロジェクト構造設計.md`
- `docs/40_詳細設計書/02_データベース設計.md`
- `docs/40_詳細設計書/03_API設計.md`
- `docs/40_詳細設計書/04_ID設計規約.md`
- `docs/40_詳細設計書/05_実装ガイドライン.md`
- `docs/40_詳細設計書/06_テナント退会時データ削除設計.md`
- `docs/60_手順書/01_開発参画/01_開発環境構築.md`
- `docs/60_手順書/02_プロジェクト構築/01_CICD構築.md`
- `docs/60_手順書/02_プロジェクト構築/03_GitHub設定.md`
- `docs/70_ADR/001_ID形式の選定.md`
- `docs/70_ADR/005_データベースツールキットの選定.md`
- `docs/70_ADR/007_テナント退会時のデータ削除方針.md`
- `docs/06_技術ノート/Make.md`
- `docs/06_技術ノート/REST_API設計.md`
- `docs/06_技術ノート/Rustエラーハンドリング.md`
- `docs/06_技術ノート/sqlx-cli.md`
- `docs/06_技術ノート/モノレポディレクトリ構成.md`

### 新規ファイル（1 ファイル）

- `docs/06_技術ノート/エンタープライズ認証とID管理.md`

## 議論の経緯

### ドキュメント参照の修正漏れ

ユーザーから、PR #41 の対応に漏れがあり、コア要件の中の連番が間違っているという指摘があった。また、ADR への参照が古いままという問題も報告された。

### 技術用語の解説要望

コア要件に結構難しい用語が並んでいる（SCIM プロビジョニングなど）ため、技術ノートか何かに解説がほしいという要望があった。

### 学習方法についての相談

こういう知識をどう独学で身につければいいかという相談があった。Keycloak や Auth0 の無料枠を使ってローカルで SAML/OIDC/SCIM を実際に試す方法を案内した。

## 学んだこと

1. **ドキュメント再編時のチェックリスト**: ディレクトリ構造を変更する際は、grep で旧パスを網羅的に検索すべき
2. **Mermaid の構文**: ER 図の関係ラベルにスペースを含む場合はダブルクォートで囲む必要がある
3. **エンタープライズ認証の学習方法**: Keycloak や Auth0 の無料枠を使えばローカルで SAML/OIDC/SCIM を実際に試せる

## 次のステップ

- コア要件の他の難解用語についても技術ノートを拡充する（イベントソーシング、CQRS 等）

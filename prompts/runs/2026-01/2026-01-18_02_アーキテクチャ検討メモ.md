# アーキテクチャ検討メモ: レイヤー型 vs バーティカルスライス

## 概要

Issue #34 実装中に、コード構成についての検討事項が発生した。

## 検討事項

現在のアーキテクチャはレイヤー型（オニオン/ヘキサゴナル）を採用している:

```
crates/
├── domain/
├── infra/
└── shared/
```

auth 機能の実装が `domain`, `infra`, `core-api` に分散しており、バーティカルスライス型への移行を検討する余地がある。

### バーティカルスライス型のイメージ

```
features/
└── auth/
    ├── domain.rs
    ├── repository.rs
    ├── usecase.rs
    └── handler.rs
```

### トレードオフ

| 観点 | レイヤー型（現在） | バーティカルスライス |
|------|------------------|-------------------|
| 変更の局所性 | レイヤー横断で修正 | 機能内で完結 |
| 共通化 | レイヤー内で自然に共有 | 明示的に shared へ切り出す必要 |
| 学習曲線 | DDD/クリーンアーキテクチャの定番 | 比較的新しいパターン |
| 大規模化 | レイヤーが肥大化しやすい | 機能追加がスケールしやすい |

## 結論

Issue #34（ユーザー認証）を一通り実装してから改めて検討する。

実装が完了した時点で、以下を評価する:
- auth 機能の実装が分散していることによる実際の痛み
- 他の機能（workflow, task）を実装する際の見通し
- リファクタリングのコスト

## 関連

- Issue: [#34 ユーザー認証](https://github.com/ka2kama/ringiflow/issues/34)
- 現在の構造: [02_プロジェクト構造設計.md](../../docs/02_基本設計書/02_プロジェクト構造設計.md)

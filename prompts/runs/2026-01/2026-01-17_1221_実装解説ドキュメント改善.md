# 2026-01-17_05: 実装解説ドキュメント改善

## 概要

実装解説ドキュメントの構成を改善し、ドメイン用語との対応をコード側のドキュメントコメントに移動した。

## 背景と目的

Phase 1 の実装解説ドキュメント作成中に、「ドメイン用語との対応」セクションの配置について検討した結果、以下の整理を行った:

- **コードのドキュメントコメント**: 型がドメイン上何を表すか（恒久的な情報）
- **実装解説**: このフェーズで何を実装したか、設計判断の解説（レビュー・学習用の記録）

## 実施内容

### 1. コード側にドメイン用語を追記

`user.rs` と `role.rs` のモジュールドキュメントコメントに「ドメイン用語」セクションを追加:

```rust
//! ## ドメイン用語
//!
//! | 型 | ドメイン用語 | 要件 |
//! |---|------------|------|
//! | [`User`] | ユーザー | CORE-03: ユーザー区分（...） |
```

Rust のドキュメントコメント内ではファイルシステムへの相対パスリンクが機能しないため、リンクを削除し要件 ID のみを記載する形式とした。

### 2. 実装解説からドメイン用語セクションを削除

`docs/90_実装解説/01_認証機能/01_Phase1_UserRepository.md` から「ドメイン用語との対応」セクションを削除。

### 3. リンクパスの修正

実装解説内の相対パスリンクが誤っていたため修正:

| 修正前 | 修正後 |
|-------|--------|
| `../../../40_詳細設計書/` | `../../40_詳細設計書/` |
| `../../../06_技術ノート/` | `../../06_技術ノート/` |

### 4. README.md を更新

`docs/90_実装解説/README.md` を現在の実装解説の構成に合わせて更新:

- 「対応 Issue」を「概要」のサブセクションとして明記
- 「後半: 設計解説」の構成を具体化（場所、コード例、なぜこの設計か、代替案）

## 成果物

### 変更ファイル

| ファイル | 変更内容 |
|---------|---------|
| `backend/crates/domain/src/user.rs` | ドメイン用語セクション追加 |
| `backend/crates/domain/src/role.rs` | ドメイン用語セクション追加 |
| `docs/90_実装解説/README.md` | 構成の明確化 |
| `docs/90_実装解説/01_認証機能/01_Phase1_UserRepository.md` | ドメイン用語セクション削除、リンク修正 |
| `CLAUDE.md` | 実装解説の追加（前セッションからの継続） |

## 議論の経緯

### ドキュメントの役割分担

「ドメイン用語との対応」セクションについて、ユーザーから、それはどちらかというとコード側に記載するものではないかという指摘があった。実装解説とコードコメント（ドキュメントコメント含む）は役割が違うという観点から、恒久的な情報はコード側に、一時的な記録はドキュメント側に配置する方針に整理した。

### リンクパスの誤り

ユーザーから、ドキュメントへのリンクが間違っているという指摘があった。相対パスの階層が誤っていたため修正した。

## 学んだこと

1. **ドキュメントの役割分担**: 恒久的な情報（型の意味）はコードに、一時的な記録（実装経緯）はドキュメントに
2. **Rust ドキュメントコメントのリンク**: ファイルシステムの相対パスは機能しない。外部ドキュメントへのリンクは URL か、リンクなしのテキスト参照にする
3. **相対パスの確認**: `docs/90_実装解説/01_認証機能/` から `docs/40_詳細設計書/` へは `../../` であり `../../../` ではない

## 次のステップ

Issue #34 Phase 2（PasswordHasher）の実装に進む。

# 2026-01-15_02: コメント簡素化と技術ノート移行

## 概要

設定ファイルやソースコード内の詳細コメントを技術ノートに移行し、コード内は簡潔なコメント + リンクのみに統一した。また、外国語名のカタカナ併記規約とドキュメント参照のリンク形式規約を追加した。

## 背景と目的

CLAUDE.md の方針「コードコメントは簡潔に、詳細は技術ノートへ」に基づき、設定ファイル（ci.yml、dependabot.yml、vite.config.js）やソースコード（Ports.elm）に散在していた詳細なコメントを整理し、技術ノートへ集約することで:

- 設定ファイルの可読性向上
- 技術知識の一元管理
- 重複の排除

を実現する。

## 実施内容

### 1. 設定ファイルの簡素化

| ファイル | Before | After | 削減率 |
|---------|--------|-------|--------|
| ci.yml | 254行 | 177行 | 30% |
| dependabot.yml | 100行 | 40行 | 60% |
| vite.config.js | 154行 | 29行 | 81% |

### 2. ソースコードの簡素化

| ファイル | Before | After | 削減率 |
|---------|--------|-------|--------|
| Ports.elm | 178行 | 37行 | 79% |

### 3. 技術ノートの更新・作成

- `GitHubActions.md`: paths-filter セクションを追加
- `Vite.md`: 新規作成（Vite の概要、選択理由、プラグイン、プロキシ設計）

### 4. 規約の追加

- `.claude/rules/docs.md`: 外国語名のカタカナ併記規約
- `.claude/rules/code-comments.md`: 新規作成（ドキュメント参照のリンク形式、コメントの原則）

### 5. 技術ノートのタイトル修正（カタカナ併記）

- Elm（エルム）、Rust（ラスト）、Cargo（カーゴ）、Vite（ヴィート）
- Dependabot（ディペンダボット）、Event Sourcing（イベントソーシング）
- BFF（Backend for Frontend）、sqlx-cli（エスキューエルエックス・シーエルアイ）

## 成果物

### 作成ファイル

- `docs/05_技術ノート/Vite.md`
- `.claude/rules/code-comments.md`

### 更新ファイル

- `.github/workflows/ci.yml`
- `.github/dependabot.yml`
- `apps/web/vite.config.js`
- `apps/web/src/Ports.elm`
- `docs/05_技術ノート/GitHubActions.md`
- `docs/05_技術ノート/Elmアーキテクチャ.md`
- `docs/05_技術ノート/Rustエラーハンドリング.md`
- `docs/05_技術ノート/Cargoワークスペース.md`
- `docs/05_技術ノート/Elmポート.md`
- `docs/05_技術ノート/Dependabot.md`
- `docs/05_技術ノート/BFFパターン.md`
- `docs/05_技術ノート/sqlx-cli.md`
- `docs/05_技術ノート/EventSourcingとデータ削除.md`
- `.claude/rules/docs.md`

## 設計判断と実装解説

### コメントを残す基準

| 種類 | 対応 |
|------|------|
| 一般的な技術知識 | 技術ノートに移行 |
| ADR と重複 | 削除し ADR を参照 |
| プロジェクト固有の設定意図 | 簡潔に残す |

### カタカナ併記の基準

| 併記すべき | 不要 |
|-----------|------|
| 発音が自明でない名前（Vite、Elm、Cargo） | 広く知られているもの（GitHub、API、REST） |
| 展開形が分かりにくい略語（BFF） | — |

## 議論の経緯

### コメントの技術ノート移行

ci.yml のコメントについて、技術ノートに移行した方がいいものがあるか確認があった。汎用的な知識を技術ノートに切り出し、コードのコメントはシンプルに保つ方針とした。

### 発音カタカナ併記

ツール名やライブラリ名などが外国語の場合、一番近い発音のカタカナを併記するよう依頼があった。全部ではなく塩梅が難しいという指摘があり、発音が自明でない名前に限定する方針を決めた。

### ドキュメントリンク

ドキュメントへの参照は可能な限りリンクにするよう依頼があり、その旨を指示に明記した。docs のルールがコードを書くときにも守られるか確認があった。

## 学んだこと

- 設定ファイルのコメントは「なぜこの設定か」に絞り、「この設定は何か」は技術ノートに委譲するのが効果的
- ルールファイルは paths で適用範囲を限定できるため、関心の分離に有効
- カタカナ併記は「発音が自明でないもの」に絞ることでノイズを減らせる

# 2026-01-17_03: Draft PR 運用導入

## 概要

Issue 駆動開発において、ブランチ作成後すぐに Draft PR を作成する運用を導入した。
Draft PR では自動レビューをスキップし、Ready for Review 時にレビューを実行する。

## 背景と目的

Issue 駆動開発のフローにおいて、以下の課題があった:

- 実装完了後に PR を作成する運用では、作業中の状態が GitHub 上で見えない
- PR Description に設計メモや検討事項を蓄積しにくい

一方で、WIP コードへの自動レビューはノイズになりがちという懸念もあった。

## 実施内容

1. **workflow 修正**: Draft PR を自動レビューから除外
   - `github.event.pull_request.draft == false` 条件を追加

2. **手順書更新**: 開発フローに Draft PR 運用を組み込み
   - フローチャートを更新
   - 「3. Draft PR を作成」セクションを追加
   - 「6. Ready for Review」セクションを追加
   - セクション番号を再構成（1→8）

3. **ADR 作成**: 意思決定の記録
   - ADR-013: Draft PR 運用の導入

## 成果物

### 変更ファイル

| ファイル | 変更内容 |
|---------|---------|
| `.github/workflows/claude-review.yml` | Draft PR 除外条件を追加 |
| `docs/04_手順書/04_開発フロー/01_Issue駆動開発.md` | Draft PR 運用を追加、フロー再構成 |
| `docs/05_ADR/013_Draft_PR運用の導入.md` | 新規作成 |

## 設計判断と実装解説

### なぜ Draft PR で自動レビューをスキップするか

| 選択肢 | 評価 |
|--------|------|
| Draft でもレビュー実行 | WIP コードへの指摘がノイズになる |
| Ready for Review 時のみ | 完成度の高いコードに対して効率的なレビュー |

設計段階でフィードバックが欲しい場合は `@claude` メンションで手動対応できるため、自動レビューは Ready for Review 時のみとした。

### 空コミットの扱い

Draft PR 作成時に空コミットを使用するが、マージ時は `--squash` を使用するため履歴に残らない。

## 議論の経緯

### Draft PR 運用の提案

ユーザーから、本 PR より先に Draft PR を作る運用はどうかという提案があった。作業中の状態を GitHub 上で可視化し、PR Description に設計メモや検討事項を蓄積しやすくする狙いがあった。

### 自動レビューの適用範囲

Draft PR でも Claude Code Action のレビューを受けた方がいいかという議論があった。WIP コードへの指摘がノイズになる可能性を考慮し、自動レビューは Ready for Review 時のみとする方針に決定した。

## 学んだこと

- GitHub Actions で Draft PR を除外するには `github.event.pull_request.draft == false` を使用する
- `gh pr ready` コマンドで Draft から Ready for Review に変更できる
- squash マージを使用していれば、途中の空コミットは履歴に残らない

## 次のステップ

- 実際の開発で Draft PR 運用を試す
- 運用上の問題があれば調整

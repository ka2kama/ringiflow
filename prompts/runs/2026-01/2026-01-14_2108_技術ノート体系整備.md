# 2026-01-14_06_技術ノート体系整備

## 概要

ドキュメント体系に「技術ノート」カテゴリを新設し、技術の知見を形式知として残す仕組みを構築した。
sqlx-cli を題材に、ADR（意思決定記録）と技術ノート（知識整理）の役割分担を明確化した。

## 背景と目的

Phase 0 完了確認の過程で sqlx-cli が未インストールであることが判明。
ユーザーから「sqlx-cli とは何か」という質問があり、その説明を行った。

このやりとりを通じて、技術の知見を文書として残したいという要望が生まれた。
既存のドキュメント体系（要件定義書、設計書、手順書、ADR）では、ツールの使い方や概念説明を置く場所が明確でなかったため、新しいカテゴリを検討した。

## 実施内容

### 1. ドキュメント配置方針の検討

以下の選択肢を提示:

| 案 | 配置場所 | 用途 |
|----|---------|------|
| A | ADR に追加 | 技術選定の意思決定（なぜ SQLx か） |
| B | 技術ノートを新設 | ツールの使い方・概念説明 |
| C | 設計書に統合 | アーキテクチャと密接な知識 |

ユーザーの選択: **A + B の併用**

### 2. 技術ノートディレクトリの新設

`docs/05_技術ノート/` を作成し、README で以下を定義:
- ADR との違い（WHY vs WHAT/HOW）
- ファイル命名規則
- 推奨セクション構成

### 3. sqlx-cli 技術ノートの作成

以下の内容を含む技術ノートを作成:
- インストール方法
- 主なコマンド一覧
- 使い方（マイグレーション作成〜実行）
- オフラインモード（CI 対応）
- トラブルシューティング

### 4. SQLx 選定 ADR の作成

ADR-005 として、データベースツールキットの選定を記録:
- 検討した選択肢: SQLx, Diesel, SeaORM
- 比較観点: 非同期サポート、コンパイル時検証、学習コスト、SQL 可視性
- 選定理由: 非同期ネイティブ、学習効果最大化、コンパイル時検証

### 5. CLAUDE.md の更新

ドキュメント体系テーブルと役割分担セクションに技術ノートを追加。

## 成果物

### 作成ファイル

| ファイル | 説明 |
|---------|------|
| `docs/05_技術ノート/README.md` | 技術ノートの目的・書き方ガイド |
| `docs/05_技術ノート/sqlx-cli.md` | sqlx-cli の機能・使い方 |
| `docs/04_ADR/005_データベースツールキットの選定.md` | SQLx 選定の意思決定記録 |

### 更新ファイル

| ファイル | 変更内容 |
|---------|---------|
| `CLAUDE.md` | ドキュメント体系に技術ノートを追加 |

## 設計判断と実装解説

### ADR と技術ノートの役割分担

| 観点 | ADR | 技術ノート |
|------|-----|-----------|
| 焦点 | なぜその決定をしたか（WHY） | その技術は何か、どう使うか（WHAT/HOW） |
| 更新 | 原則不変 | 知識が増えたら更新可 |
| 例 | 「なぜ SQLx を選んだか」 | 「sqlx-cli の使い方」 |

この分離により:
- ADR は意思決定の記録として不変性を保てる
- 技術ノートは知識の蓄積として自由に更新できる
- 新規参画者は「なぜ」と「どう使うか」を別々に参照できる

## ユーザープロンプト（抜粋）

> sqlx-cli はなにをするもので、なぜインストールが必要なのですか？

> こういう技術の知見みたいなものもどこかに文書で残したいです。

## 学んだこと

- ドキュメントは「問い」ごとに分類すると整理しやすい
  - WHAT（要件定義書）、HOW（設計書）、HOW TO（手順書）、WHY（ADR）、WHAT/HOW（技術ノート）
- 技術選定（WHY）と技術の使い方（HOW）は別の知識であり、別ドキュメントにすべき
- 「暗黙知ゼロ」の理念は、会話の中で生まれた知識も文書化する動機になる

## 次のステップ

1. sqlx-cli のインストール
2. Phase 0 完了確認（`just setup`）
3. Phase 1 開始（DB スキーマ作成）

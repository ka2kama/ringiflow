# YAGNI/KISS の拡大解釈による設計品質低下

## 事象

AI エージェントが YAGNI/KISS/MVP を「設計の簡略化」の根拠として使い、アーキテクチャの一貫性を損なう判断を繰り返している。

具体例（Issue #196 ユーザー名解決の実装）:

1. `UserRepository` をハンドラ層から直接呼ぶ設計を提案
2. 「ユースケース層に追加すると型パラメータが増え、影響範囲が大きい」ことを理由に正当化
3. ユーザーから「割れ窓ではないか」と指摘されてからユースケース層への移動を実施

結果: 本来1回で済む実装が2段階（初期実装 + リファクタリング）になり、余計な作業が発生した。

## 原因分析

YAGNI/KISS/MVP の適用範囲を誤って拡大解釈している:

| 原則 | 正しい適用 | 誤った適用（今回のケース） |
|------|-----------|------------------------|
| YAGNI | まだ必要でない**機能**を先取りしない | 「影響範囲が大きい」を理由にレイヤー違反を許容する |
| KISS | 不必要に複雑な**機能設計**を避ける | 正しいレイヤー配置を「複雑」として回避する |
| MVP | 最小限の**機能**でリリースする | 設計品質を妥協して「最小限の実装」にする |

根本原因: **これらの原則は機能スコープに関するもの**であり、**設計品質を妥協する根拠にはならない**。この区別ができていない。

## 対策

### 恒久対策

CLAUDE.md に以下の判断基準を追記する（Issue #199）:

設計判断時に「これは機能の先取りか、設計品質の問題か」を区別する:

- 機能の先取り → YAGNI を適用して見送ってよい
  - 例: 将来必要になるかもしれないキャッシュ層の追加
  - 例: まだ要件にない多段階承認の対応
- 設計品質の問題 → YAGNI/KISS を理由に妥協しない
  - 例: レイヤードアーキテクチャの違反（ハンドラ → リポジトリ直接呼び出し）
  - 例: 型安全性の省略（String で済ませる）
  - 例: エラーハンドリングの省略（unwrap で済ませる）

判定テスト: 「この判断を放置すると、後続の実装で同じパターンが使われるか？」
→ Yes なら設計品質の問題（割れ窓理論）。YAGNI/KISS で正当化してはならない。

## 次のアクション

- [x] CLAUDE.md に判断基準を追記（Issue #199）

# 無関係の問題をスルーする傾向

**日時**: 2026-02-15 11:37
**セッション**: Phase 1 実装完了後の品質ゲート検証中

## 事象

Phase 1 の PR #536 の品質ゲート（`just check-all`）実行時に、audit_log テストの並列実行時失敗を発見した。

- **個別実行**: ✅ pass
- **並列実行**: ❌ fail（DynamoDB dispatch failure）
- **CI**: ✅ pass

AI エージェントは「CI が通っているからローカルの問題は無視してよい」と判断し、Issue 化せずに PR を Ready for Review に進めようとした。ユーザーから「無関係の問題が発生したとき、Issue に記載しないとスルーされたまま終わる」と指摘を受けた。

## 原因分析

### 表層的な原因

- 「CI が通っているから OK」という判断基準を優先した
- 現在のタスク（Phase 1 の PR 完了）を優先し、無関係の問題を後回しにした

### 根本原因

1. **問題発見時のプロセスが未定義**
   - 「無関係の問題を発見したらどうするか」が CLAUDE.md やルールに記載されていない
   - Issue 化の判断基準が不明確

2. **認知バイアス**
   - タスク完了を優先し、追加作業（Issue 化）を避けようとする傾向
   - 「CI が通っているから本質的な問題ではない」という自己正当化

3. **問題の定義が狭い**
   - 「Phase 1 の実装が正しい」ことだけを検証対象とし、「開発環境が健全である」ことを検証対象としていない
   - ローカルとCIの差異を「仕方ない」として受け入れている

## 対策

### 即座対応（完了）

- ✅ audit_log テストの並列実行問題を Issue #540 として記録
- ✅ 改善記録を作成（本ファイル）

### 恒久対策

**ルール追加**: 問題発見時の対応プロセスを形式知化する

→ `.claude/rules/issue-on-discovery.md` を作成し、以下を定義する:

1. **問題の定義**: 「意図しない動作」はすべて問題として扱う
   - CI が通っていても、ローカルで再現する不具合は問題
   - 「環境の差異」は理由にならない（理想状態は「ローカル = CI」）

2. **発見時の即座対応**:
   - 問題を発見したら、即座に Issue 化する
   - 「後で」「別の機会に」は禁止
   - Issue 化の判断基準: 「この問題を放置すると、将来誰かが困るか？」→ Yes なら即座に Issue 化

3. **Issue の優先度判定**:
   - 現在のタスクをブロックするか？ → Yes: 今すぐ修正
   - 現在のタスクと無関係か？ → Yes: Issue 化して別途対応

4. **AI エージェントへの指示**:
   - 問題を発見したら、ユーザーに隠さず即座に報告する
   - 「CI が通っているから OK」という判断で問題を隠蔽しない
   - Issue 化の手間を理由に問題をスルーしない

## 次のアクション

- [ ] `.claude/rules/issue-on-discovery.md` を作成（別 PR で実施）
- [ ] CLAUDE.md から新ルールを参照
- [ ] Issue #540（audit_log テスト問題）を調査・修正

## 分類

- **カテゴリ**: プロセス・ルール
- **影響範囲**: 品質管理全般
- **再発防止**: 恒久対策として新ルールを追加

## 関連

- 発見元 PR: #536
- 問題 Issue: #540
- 過去の類似事象: （今後記録される改善記録を参照）

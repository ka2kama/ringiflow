# 設計フェーズにおける理想駆動の省略

## 発生日時

2026-02-05

## 概要

Issue #247（タスク API の display_number 対応）で、自己検証プロトコルを実施せずに実装を開始しようとした。

## 事象

1. Issue #247 を確認し、「#229 と同じパターン」と判断
2. 探索で設計上の問題（display_number のスコープ）を発見
3. ユーザーと設計を議論し、階層構造を採用
4. **自己検証を実施せずに** TDD でテストを書き始めた
5. ユーザーから「理想駆動は問題なくできた？」と指摘を受けた

## 根本原因

1. **フローに組み込まれていない**: Issue 駆動開発の設計フェーズに自己検証ステップが明示されていなかった
2. **「スキップ可能」の条件が緩い**: 「既存パターンの踏襲」という曖昧な条件でスキップ可能だった
3. **行動規範 vs 構造的強制**: 「やるべき」と書いてあるだけでは実行されない

## 対策

Issue 駆動開発の手順書を改訂:

1. **設計フェーズのフローチャートに「自己検証」を追加**
   - 基本設計確認 → 詳細設計作成 → 実装計画作成 → **自己検証** → 設計成果物のコミット

2. **4.4 自己検証セクションを追加**
   - To-Be 定義、チェックリスト実施、計画への記載を必須化
   - 「自己検証セクションのない計画で実装を開始すること」を禁止

3. **設計フェーズの簡略化条件を厳格化**
   - 「既存パターンの踏襲」→「新しい設計判断が不要」に変更
   - 判定テスト: 「この変更には選択肢があるか？」→ Yes なら設計判断が必要
   - 簡略化しても自己検証（4.4）は省略不可

## 学び

- 行動規範（「やるべき」）は実行されない。構造的強制（「フローの一部」）にする必要がある
- 「既存パターンの踏襲」という判断は危険。新しい設計判断が潜んでいる可能性がある
- 理想駆動はプロジェクトの核。フローに組み込むことで確実に実行される

## 関連

- [自己検証プロトコル](.claude/rules/self-review.md)
- [自己検証ループの自動実行欠如](./2026-02-05_2100_自己検証ループの自動実行欠如.md)
- [Issue 駆動開発](docs/04_手順書/04_開発フロー/01_Issue駆動開発.md)

## 検証（対策実行後に追記）

- 実施日: 2026-02-06
- 対策の実行状況: 実行済み
- 効果: `docs/04_手順書/04_開発フロー/01_Issue駆動開発.md` に、設計フェーズの簡略化条件（「既存パターンの踏襲」→「新しい設計判断が不要」）と判定テスト（「この変更には選択肢があるか？」→ Yes なら設計判断が必要）が追加された。フローチャートに自己検証ステップが明示的に組み込まれ、構造的な強制力が確保された
- 備考: なし

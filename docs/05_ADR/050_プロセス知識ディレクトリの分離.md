# ADR-050: プロセス知識ディレクトリの分離

## ステータス

承認済み

## コンテキスト

#458 で改善記録（`prompts/improvements/`）のスコープを「AI エージェント運用」から「開発プロセス全般」に拡大した。これにより、`prompts/`（LLM プロンプト）というディレクトリ名と `improvements/` の内容に概念的なずれが生じた。

プロジェクトには3種の知識がある:

| 知識の種類 | 内容 |
|-----------|------|
| プロダクト知識 | 要件、設計、アーキテクチャ、手順書 |
| AI セッション知識 | セッションログ、計画ファイル、操作レシピ |
| プロセス知識 | 改善記録、診断レポート |

従来、プロセス知識が AI セッション知識と同じ `prompts/` ディレクトリに混在していた。

## 検討した選択肢

### 選択肢 A: `improvements/` のみ移動

最も概念的ずれが大きい `improvements/` だけを `prompts/` の外に移動する。

評価:
- 利点: 最小変更で最大の概念的改善
- 欠点: `reports/` も「どちらとも言える」ため、将来同じ議論が発生する可能性

### 選択肢 B: `prompts/` を丸ごとリネーム

`prompts/` 全体をより適切な名前（`devlog/` 等）に変更する。

評価:
- 利点: 概念的に最もクリーン
- 欠点: 変更コスト大（428 ファイル + 136 参照ファイル）。git 履歴の追跡が困難

### 選択肢 C: README 更新のみ

ディレクトリ構造は変更せず、`prompts/README.md` の定義を更新する。

評価:
- 利点: 変更コストゼロ
- 欠点: 名前と内容のずれが残る（割れ窓理論）

### 選択肢 D: `improvements/` と `reports/` を移動

プロセス知識（改善記録 + 診断レポート）をまとめて新しいトップレベルディレクトリに移動する。

評価:
- 利点: プロセス知識と AI セッション知識の完全分離。将来の再議論を回避
- 欠点: 選択肢 A より若干変更コストが大きい（CI workflow の修正が追加）

### 比較表

| 観点 | A: improvements のみ | B: リネーム | C: README のみ | D: 両方移動 |
|------|---------------------|------------|---------------|------------|
| 概念的クリーンさ | ○ | ◎ | △ | ◎ |
| 変更コスト | 小 | 大 | ゼロ | 小〜中 |
| git 履歴への影響 | 小 | 大 | なし | 小 |
| 将来の拡張性 | ○ | ◎ | △ | ◎ |

## 決定

選択肢 D を採用する。`improvements/` と `reports/` を新しいトップレベルディレクトリ `process/` に移動する。

```
docs/       → プロダクト知識
prompts/    → AI セッション知識（runs, plans, recipes）
process/    → プロセス知識（improvements, reports）
```

選択理由:
1. プロセス知識と AI セッション知識を概念的に完全分離できる
2. 変更コストが許容範囲（~25 外部参照ファイルの更新）
3. 選択肢 A と比較して、`reports/` の将来的な再議論を回避

選択肢 B を却下した理由: 136 参照ファイルの更新コストが priority:low の Issue に対して過剰。

## 帰結

### 肯定的な影響

- ディレクトリ名と内容の概念的一貫性が向上
- 三層知識構造（docs/prompts/process）により、新しいプロセス知識の格納先が明確
- `prompts/` が純粋に AI セッション成果物のみを含むようになり、スコープが明確

### 否定的な影響・トレードオフ

- `prompts/runs/` と `prompts/plans/` 内の歴史的記録に古いパス（`prompts/improvements/`）が残る。更新は歴史の改竄に近く、コスト対効果が見合わないため許容する
- トップレベルディレクトリが1つ増加する

### 関連ドキュメント

- 基本設計書: [プロジェクト構造設計](../02_基本設計書/02_プロジェクト構造設計.md)
- 実装: #460

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2026-02-17 | 初版作成 |

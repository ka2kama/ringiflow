# ADR-013: Draft PR 運用の導入

## ステータス

承認済み

## コンテキスト

Issue 駆動開発において、PR を作成するタイミングと自動レビューの実行タイミングについて検討が必要になった。

現状の課題:
- 実装完了後に PR を作成する運用では、作業中の状態が GitHub 上で見えない
- 設計段階でのフィードバックを得にくい
- PR Description に思考過程や検討事項を蓄積しにくい

一方で:
- WIP（作業中）のコードに対する自動レビューはノイズになりがち
- 形が定まっていないコードへの指摘は的外れになることが多い

## 検討した選択肢

### 選択肢 1: 従来通り（実装完了後に PR 作成）

実装が完了してから PR を作成し、レビューを受ける。

評価:
- 利点: シンプル、レビューは完成したコードに対して行われる
- 欠点: 作業状況が見えない、設計段階でのフィードバックが得られない

### 選択肢 2: Draft PR を先に作成し、自動レビューも実行

ブランチ作成後すぐに Draft PR を作成し、push のたびに自動レビューを実行する。

評価:
- 利点: 常にフィードバックを得られる、問題の早期発見
- 欠点: WIP コードへのレビューはノイズ、API コスト増加

### 選択肢 3: Draft PR を先に作成し、自動レビューは Ready for Review 時のみ

ブランチ作成後すぐに Draft PR を作成するが、自動レビューは Ready for Review に変更した時点で実行する。

評価:
- 利点: 作業状況の可視化と効率的なレビューを両立
- 欠点: 設計段階での自動レビューは受けられない（手動で @claude メンションは可能）

### 比較表

| 観点 | 選択肢 1 | 選択肢 2 | 選択肢 3 |
|------|---------|---------|---------|
| 作業状況の可視化 | x | o | o |
| レビューの効率性 | o | x | o |
| 設計段階のフィードバック | x | o | △（手動で可能） |
| ノイズの少なさ | o | x | o |

## 決定

**選択肢 3: Draft PR を先に作成し、自動レビューは Ready for Review 時のみ** を採用する。

主な理由:
1. 作業状況の可視化と効率的なレビューを両立できる
2. WIP コードへの的外れな指摘を避けられる
3. 設計段階でフィードバックが欲しい場合は、手動で `@claude` メンションすることで対応可能

## 帰結

### 肯定的な影響

- 作業中の PR が GitHub 上で見えるようになる
- PR Description に設計メモや検討事項を蓄積できる
- Ready for Review 後のレビューは完成度の高いコードに対して行われ、効率的
- 学習目的のプロジェクトとして、思考過程を残しやすくなる

### 否定的な影響・トレードオフ

- 設計段階での自動フィードバックは得られない（手動メンションで代替可能）
- 開発フローのステップが 1 つ増える（Draft PR 作成）
- Draft PR が長期間オープンのままになるリスク

### 関連ドキュメント

- 手順書: [Issue 駆動開発](../04_手順書/04_開発フロー/01_Issue駆動開発.md)
- 実装: [.github/workflows/claude-review.yml](../../.github/workflows/claude-review.yml)

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2026-01-17 | 初版作成 |

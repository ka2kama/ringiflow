# 実装解説

コードの理解を促進するための解説ドキュメントを管理する。

> ⚠️ 本ディレクトリの内容は作成当時の解説であり、コード変更に追従してメンテナンスされるものではない。

## 目的

1. レビュー支援: 実装内容を理解し、品質を検証できる
2. 学習効果: 設計判断の理由、代替案、トレードオフを学べる
3. 知識の蓄積: 将来の参照用として設計意図を残す

## 生成方法

`/explain` で2つのドキュメントを対で生成する。

| ドキュメント | 視点 | 読者の問い |
|-------------|------|-----------|
| 機能解説 | 機能・概念（What / Why） | どう動くのか？なぜこう設計されたか？ |
| コード解説 | ソースコード（How / Where） | どのコードがどう構成されているか？ |

対象は PR diff でも既存機能でもよい。

```bash
/explain 123          # PR #123 の差分を解説
/explain 認証フロー    # 既存機能を解説
```

構成の詳細: [`.claude/skills/explain/SKILL.md`](../../.claude/skills/explain/SKILL.md)

## ディレクトリ構造

```
docs/07_実装解説/
├── README.md                           # 本ファイル
├── PR<番号>_<機能名>/                  # diff モード（PR 紐づき）
│   ├── NN_<トピック>_機能解説.md
│   ├── NN_<トピック>_コード解説.md
│   └── ...
└── <機能名>/                           # feature モード（既存機能の解説）
    ├── NN_<トピック>_機能解説.md
    └── ...
```

## 命名規則

### ディレクトリ名

| モード | 形式 | 例 |
|-------|------|-----|
| diff（PR 紐づき） | `PR<番号>_<機能名>/` | `PR668_PIIマスキング基盤/` |
| feature（既存機能） | `<機能名>/` | `認証フロー/` |

- diff モード: PR 番号は一意のため、worktree 並行開発でも衝突しない
- feature モード: 機能名は説明対象を端的に表す名前を付ける
- 複数 PR にまたがる diff は、最初の PR 番号を使用する

### ファイル名

```
NN_<トピック>_機能解説.md    # 機能・概念の視点（What / Why）
NN_<トピック>_コード解説.md  # ソースコードの視点（How / Where）
```

- `NN`: サブディレクトリ内の連番（`01_`, `02_`, ...）
- 機能解説とコード解説は必ずペアで作成する
- 図表を多用し、概念・フロー・コード変更を俯瞰的に解説する

## 他のドキュメントとの関係

| ドキュメント | 役割 | 実装解説との違い |
|-------------|------|-----------------|
| 設計書 | 事前の設計仕様 | 実装解説は「実際にどう作ったか」 |
| ADR | 意思決定の記録 | 実装解説は「どう実装したか」も含む |
| 技術ノート | 汎用的な技術知識 | 実装解説はプロジェクト固有の実装 |
| セッションログ | 作業記録 | 実装解説は体系的な解説 |

## 変更履歴

### 連番 → PR 番号ベースへの移行

worktree 並行開発で連番が衝突する問題を解消するため、ディレクトリ名を `NN_<機能名>/` から `PR<番号>_<機能名>/` に移行した。

### 旧形式（Phase 単位）からの変換

以下は旧形式（Phase 単位）で作成されたドキュメントを `/explain` で新形式に変換したもの。全ディレクトリの変換が完了済み。

`PR46_認証機能/`、`PR105_APIテスト/`、`PR96_並行開発環境/`、`PR93_AuthService/`、`PR114_ワークフロー申請機能/`、`PR141_ワークフロー承認却下機能/`、`PR166_ダッシュボード/`、`PR197_ユーザー名解決/`、`PR215_表示用ID/`、`PR228_ドメインモデル非決定的値排除/`、`PR254_ユーザー検索UI/`、`PR264_フォームdirty-state/`、`PR268_ダッシュボードカードナビゲーション/`、`PR278_ConfirmDialogアクセシビリティ/`、`PR310_テナント情報取得/`、`PR413_マルチテナントRLS/`

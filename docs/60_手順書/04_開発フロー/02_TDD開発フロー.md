# TDD é–‹ç™ºãƒ•ãƒ­ãƒ¼

> AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ: [`.claude/rules/dev-flow-tdd.md`](../../../.claude/rules/dev-flow-tdd.md)ã€‚æœ¬ãƒ•ã‚¡ã‚¤ãƒ«ã¯æ•™è‚²ãƒ»å‚ç…§ç”¨ã€‚

## æ¦‚è¦

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ TDDï¼ˆãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºï¼‰ã‚’æ¡ç”¨ã—ã€ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã§å®Ÿè£…ã‚’é€²ã‚ã‚‹ã€‚
t_wadaï¼ˆå’Œç”°å“äººï¼‰ã® TDD æ‰‹æ³•ã‚’åŸºæœ¬ã¨ã—ã€ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«çš„ã« MVP ã‚’ç©ã¿ä¸Šã’ã‚‹ã€‚

### æ¡ç”¨ç†ç”±

| è¦³ç‚¹ | TDD ã®ãƒ¡ãƒªãƒƒãƒˆ |
|------|---------------|
| å“è³ª | ãƒã‚°ã®æ—©æœŸç™ºè¦‹ã€ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³é˜²æ­¢ |
| è¨­è¨ˆ | ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„è¨­è¨ˆ = è‰¯ã„è¨­è¨ˆ |
| å­¦ç¿’ | å°ã•ãªã‚¹ãƒ†ãƒƒãƒ—ã§ç€å®Ÿã«ç†è§£ã‚’æ·±ã‚ã‚‰ã‚Œã‚‹ |
| å®‰å¿ƒ | å‹•ãã‚³ãƒ¼ãƒ‰ã‚’å¸¸ã«ç¶­æŒã€å¤§èƒ†ãªãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå¯èƒ½ |

---

## TDD ã‚µã‚¤ã‚¯ãƒ«

```mermaid
flowchart LR
    R["ğŸ”´ Red"] --> G["ğŸŸ¢ Green"]
    G --> RF["ğŸ”µ Refactor"]
    RF --> R
```

### ç¢ºèªäº‹é …ã®å®Ÿæ–½

**ç›®çš„:** æ¨æ¸¬ã§ã¯ãªãäº‹å®Ÿã«åŸºã¥ã„ã¦ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã

â†’ å“²å­¦ã¨åŸå‰‡: [å®Ÿè£…å‰ã®ç¢ºèª](../../../.claude/rules/pre-implementation.md)
â†’ æ‰‹é †ã®è©³ç´°: [AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ](../../../.claude/rules/dev-flow-tdd.md#ç¢ºèªäº‹é …ã®å®Ÿæ–½)

---

### ğŸ”´ Red: å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ›¸ã

**ç›®çš„:** å®Ÿè£…ã™ã¹ãæŒ¯ã‚‹èˆã„ã‚’æ˜ç¢ºã«ã™ã‚‹

â†’ æ‰‹é †ã®è©³ç´°: [AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ](../../../.claude/rules/dev-flow-tdd.md#red-å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ›¸ã)

```rust
#[tokio::test]
async fn test_find_user_by_email_returns_user_when_exists() {
    // Arrange
    let repo = setup_test_repository().await;

    // Act
    let result = repo.find_by_email(&tenant_id, &email).await;

    // Assert
    assert!(result.is_ok());
    assert!(result.unwrap().is_some());
}
```

#### äºŒå±¤ã® Red ãƒ¢ãƒ‡ãƒ«

é™çš„å‹ä»˜ãè¨€èªï¼ˆRust / Elmï¼‰ã§ã¯ã€ãƒ†ã‚¹ãƒˆã‹ã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãŒ 2 å±¤ã«ãªã‚‹ã€‚

â†’ æ‰‹é †ã®è©³ç´°: [AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ](../../../.claude/rules/dev-flow-tdd.md#äºŒå±¤ã®-red-ãƒ¢ãƒ‡ãƒ«)

```mermaid
flowchart LR
    T["ãƒ†ã‚¹ãƒˆè¨˜è¿°"] --> RC["ğŸ”´ Red<br/>(compile)"]
    RC --> GC["ã‚¹ã‚¿ãƒ–ä½œæˆ<br/>todo!()"]
    GC --> RT["ğŸ”´ Red<br/>(test failure)"]
    RT --> G["ğŸŸ¢ Green"]
```

ãƒ¡ãƒ³ã‚¿ãƒ«ãƒ¢ãƒ‡ãƒ«: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯ã€Œæœ€åˆã®ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ã€ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã€Œä½•ã‚’å®šç¾©ã™ã¹ãã‹ã€ã‚’æ•™ãˆã€ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ãŒã€Œä½•ã‚’å®Ÿè£…ã™ã¹ãã‹ã€ã‚’æ•™ãˆã‚‹ã€‚ã“ã® 2 ã¤ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’æ··åŒã—ãªã„ã“ã¨ãŒé‡è¦ã€‚

Robert C. Martin ã¯ã“ã‚Œã‚’ nano-cycleï¼ˆRed å†…ã®å°ã‚µã‚¤ã‚¯ãƒ«ï¼‰ã¨å‘¼ã¶ã€‚ãƒ†ã‚¹ãƒˆã‚’æ›¸ã â†’ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã‚’è§£æ¶ˆã™ã‚‹ â†’ ãƒ†ã‚¹ãƒˆå¤±æ•—ã‚’ç¢ºèªã™ã‚‹ã€ã¨ã„ã†ä¸€é€£ã®æµã‚ŒãŒ Red ãƒ•ã‚§ãƒ¼ã‚ºå†…éƒ¨ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’æˆã™ã€‚

#### ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼è§£æ¶ˆã®åŸå‰‡

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã®è§£æ¶ˆã§ã¯ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒè¦æ±‚ã™ã‚‹æœ€å°é™ã®å®šç¾©ã ã‘ã‚’è¨˜è¿°ã™ã‚‹ã€‚

Rust ã®ä¾‹:

```rust
// ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼è§£æ¶ˆã§æ›¸ãã‚‚ã®: å‹å®šç¾© + todo!()
pub struct UserRepository {
    pool: PgPool,
}

impl UserRepository {
    pub async fn find_by_email(
        &self,
        tenant_id: &TenantId,
        email: &Email,
    ) -> Result<Option<User>> {
        todo!() // ãƒ­ã‚¸ãƒƒã‚¯ã¯ Green ãƒ•ã‚§ãƒ¼ã‚ºã§æ›¸ã
    }
}
```

Elm ã®ä¾‹:

```elm
-- ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼è§£æ¶ˆã§æ›¸ãã‚‚ã®: å‹å®šç¾© + Debug.todo
findByEmail : TenantId -> Email -> Cmd Msg
findByEmail tenantId email =
    Debug.todo "findByEmail" -- ãƒ­ã‚¸ãƒƒã‚¯ã¯ Green ãƒ•ã‚§ãƒ¼ã‚ºã§æ›¸ã
```

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®å®Ÿä¾‹: ãƒ†ã‚¹ãƒˆã‚¹ã‚¿ãƒ–ã§ `todo!()` ã‚’ä½¿ç”¨ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ â†’ `core-service/src/handler/auth/tests.rs`

é‡è¦: å¤±æ•—ã‚’ç¢ºèªã›ãšã«å®Ÿè£…ã«é€²ã¾ãªã„ã€‚å¤±æ•—ã‚’è¦‹ã‚‹ã“ã¨ã§ï¼š
- ãƒ†ã‚¹ãƒˆãŒæ­£ã—ãæ›¸ã‘ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã‚‹
- å®Ÿè£…å‰å¾Œã®å·®åˆ†ãŒæ˜ç¢ºã«ãªã‚‹

### ğŸŸ¢ Green: æœ€çŸ­ã§é€šã™

**ç›®çš„:** ãƒ†ã‚¹ãƒˆã‚’é€šã™æœ€å°é™ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã

â†’ æ‰‹é †ã®è©³ç´°: [AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ](../../../.claude/rules/dev-flow-tdd.md#green-æœ€çŸ­ã§é€šã™)

```rust
// ä»®å®Ÿè£…ã®ä¾‹ï¼ˆã¾ãšã“ã‚Œã§ãƒ†ã‚¹ãƒˆã‚’é€šã™ï¼‰
pub async fn find_by_email(&self, tenant_id: &TenantId, email: &Email) -> Result<Option<User>> {
    Ok(Some(User::new(/* ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¨åŒã˜å€¤ */)))
}
```

é‡è¦: ã“ã®æ®µéšã§ã¯ã€Œå‹•ãã€ã“ã¨ã ã‘ã«é›†ä¸­ã€‚é‡è¤‡ã‚„æ±šã„ã‚³ãƒ¼ãƒ‰ã¯è¨±å®¹ã™ã‚‹ã€‚

### ğŸ”µ Refactor: è¨­è¨ˆã‚’æ”¹å–„ã™ã‚‹

**ç›®çš„:** å‹•ä½œã‚’å¤‰ãˆãšã«è¨­è¨ˆå“è³ªã‚’é«˜ã‚ã‚‹

#### ã‚³ãƒ¼ãƒ‰ã®æ•´ç†

ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰:
1. é‡è¤‡ã‚’é™¤å»
2. å‘½åã‚’æ”¹å–„
3. æ§‹é€ ã‚’æ•´ç†

ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰:
1. ãƒ†ã‚¹ãƒˆã®æ„å›³ãŒåå‰ã‹ã‚‰èª­ã¿å–ã‚Œã‚‹ã‹ç¢ºèª
2. ä¸‰è§’æ¸¬é‡ã§è¿½åŠ ã—ãŸãƒ†ã‚¹ãƒˆã®ä¸­ã«ã€ä¸€èˆ¬åŒ–å¾Œã¯å†—é•·ã«ãªã£ãŸã‚‚ã®ãŒãªã„ã‹ç¢ºèª
3. Arrange / Act / Assert ã®æ§‹é€ ãŒæ˜ç¢ºã‹ç¢ºèª

**ãƒ†ã‚¹ãƒˆãŒé€šã‚Šç¶šã‘ã‚‹ã“ã¨ã‚’ç¢ºèªã—ãªãŒã‚‰** é€²ã‚ã‚‹ã€‚

```rust
// ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œï¼ˆå®Ÿéš›ã®DBå•ã„åˆã‚ã›ï¼‰
pub async fn find_by_email(&self, tenant_id: &TenantId, email: &Email) -> Result<Option<User>> {
    let row = sqlx::query_as!(
        UserRow,
        "SELECT * FROM users WHERE tenant_id = $1 AND email = $2",
        tenant_id.as_uuid(),
        email.as_str()
    )
    .fetch_optional(&self.pool)
    .await?;

    Ok(row.map(User::from))
}
```

#### è¨­è¨ˆåŸå‰‡ãƒ¬ãƒ³ã‚º

ã‚³ãƒ¼ãƒ‰ã®æ•´ç†ã«åŠ ãˆã¦ã€è¨­è¨ˆåŸå‰‡ã®è¦³ç‚¹ã‹ã‚‰æ”¹å–„æ©Ÿä¼šã‚’æ¢ã™ã€‚

â†’ ISO 25010 å“è³ªç‰¹æ€§ã¨ã®å¯¾å¿œ: [KB: ISO 25010 > è¨­è¨ˆåŸå‰‡ãƒ¬ãƒ³ã‚ºã¨ã®ãƒãƒƒãƒ”ãƒ³ã‚°](../../80_ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹/methodology/ISO25010.md#è¨­è¨ˆåŸå‰‡ãƒ¬ãƒ³ã‚ºã¨ã®ãƒãƒƒãƒ”ãƒ³ã‚°)

â†’ ä½ç½®ã¥ã‘: [ä¿¯ç°ãƒ»å®Ÿè£…ãƒªã‚ºãƒ  > å®Ÿè£…ä¸­ã®ä¿¯ç°](../../../.claude/rules/zoom-rhythm.md#å®Ÿè£…ä¸­ã®ä¿¯ç°-è¨­è¨ˆåŸå‰‡ãƒ¬ãƒ³ã‚º)

â†’ æ‰‹é †ã®è©³ç´°: [AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ](../../../.claude/rules/dev-flow-tdd.md#è¨­è¨ˆåŸå‰‡ãƒ¬ãƒ³ã‚º)

ã“ã‚Œã‚‰ã®è¦³ç‚¹ã¯ [å“è³ªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](01_Issueé§†å‹•é–‹ç™º.md#62-å“è³ªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ) ã®ã€Œå“è³ªå‘ä¸Šã®æœ€çµ‚ç¢ºèªï¼ˆã‚¼ãƒ­â†’ãƒ—ãƒ©ã‚¹ï¼‰ã€ã¨åŒä¸€ã®è¨­è¨ˆåŸå‰‡ã€‚ãƒ¬ãƒ³ã‚ºã¯ Refactor ã‚¹ãƒ†ãƒƒãƒ—ã§è¨­è¨ˆå“è³ªã‚’ä½œã‚Šè¾¼ã‚€ãŸã‚ã®ã‚‚ã®ã€‚å“è³ªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã¯ PR å…¨ä½“ã‚’é€šã—ãŸæœ€çµ‚ç¢ºèªã§ã‚ã‚Šã€ãƒ¬ãƒ³ã‚ºã§è¦‹é€ƒã—ãŸå•é¡Œã‚’æ•æ‰ã™ã‚‹æœ€å¾Œã®ç ¦ã€‚

æ—¢çŸ¥æ‰‹æ³•ã¨ã®å¯¾å¿œ: ã€Œæ¯ Refactorã€ã¯ Kent Beck ã® Four Rules of Simple Designï¼ˆReveals intention â†’ No duplication â†’ Fewest elementsï¼‰ã€ã€Œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å®Œæˆæ™‚ã€ã¯ SOLID åŸå‰‡ã® SRPãƒ»DIP ãŠã‚ˆã³å‹ã«ã‚ˆã‚‹ä¸æ­£çŠ¶æ…‹é˜²æ­¢ï¼ˆ"Making Illegal States Unrepresentable" â€” Minsky, 2011; "Parse, don't validate" â€” King, 2019ï¼‰ã«å¯¾å¿œã€‚

#### UI/UX ãƒ¬ãƒ³ã‚ºï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å¤‰æ›´æ™‚ï¼‰

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆElm ãƒ“ãƒ¥ãƒ¼é–¢æ•°ã€Tailwind ã‚¯ãƒ©ã‚¹ï¼‰ã‚’å¤‰æ›´ã™ã‚‹å ´åˆã€ã‚³ãƒ¼ãƒ‰è¨­è¨ˆãƒ¬ãƒ³ã‚ºã«åŠ ãˆã¦ä»¥ä¸‹ã‚’é©ç”¨ã™ã‚‹ã€‚

â†’ å‚ç…§: ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ â€” [`docs/40_è©³ç´°è¨­è¨ˆæ›¸/13_ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³.md`](../../40_è©³ç´°è¨­è¨ˆæ›¸/13_ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³.md)
â†’ å‚ç…§: ãƒ‡ã‚¶ã‚¤ãƒ³ãƒˆãƒ¼ã‚¯ãƒ³å®šç¾© â€” [`frontend/src/styles.css`](../../../frontend/src/styles.css)

â†’ æ‰‹é †ã®è©³ç´°: [AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ](../../../.claude/rules/dev-flow-tdd.md#uiux-ãƒ¬ãƒ³ã‚ºãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å¤‰æ›´æ™‚)

ã‚³ãƒ¼ãƒ‰è¨­è¨ˆãƒ¬ãƒ³ã‚ºã¨ã®å¯¾å¿œ:

| ã‚³ãƒ¼ãƒ‰è¨­è¨ˆãƒ¬ãƒ³ã‚º | å¯¾å¿œã™ã‚‹ UI/UX ãƒ¬ãƒ³ã‚º |
|----------------|---------------------|
| æ„å›³ã®æ˜ç¢ºã• | è¦–è¦šçš„éšå±¤ |
| é‡è¤‡ã®æ’é™¤ | å…±æœ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ´»ç”¨ |
| è¦ç´ ã®æœ€å°æ€§ | ï¼ˆH8 ãƒŸãƒ‹ãƒãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³ã¨ã—ã¦è¦–è¦šçš„éšå±¤ã«åŒ…å«ï¼‰ |
| å‹ã®æ´»ç”¨ | çŠ¶æ…‹ã®ç¶²ç¾…æ€§ï¼ˆRemoteData + Button.Variantï¼‰ |

æ—¢çŸ¥æ‰‹æ³•ã¨ã®å¯¾å¿œ: UI/UX ãƒ¬ãƒ³ã‚ºã®å®ˆã‚Šã¯ Nielsen ã® 10 Usability Heuristicsï¼ˆH1: çŠ¶æ…‹ã®ç¶²ç¾…æ€§ã€H4: ãƒ‡ã‚¶ã‚¤ãƒ³ãƒˆãƒ¼ã‚¯ãƒ³æº–æ‹ ã€H5/H3: ç ´å£Šçš„æ“ä½œã®é˜²å¾¡ã€H8: è¦–è¦šçš„éšå±¤ã€H9: ã‚¨ãƒ©ãƒ¼ã®ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ï¼‰ã¨ WCAG 2.1 POUR åŸå‰‡ï¼ˆã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ï¼‰ã«å¯¾å¿œã€‚æ”»ã‚ã¯ CRAP åŸå‰‡ï¼ˆRobin Williams, 2004ï¼‰ã® Contrastãƒ»Alignmentãƒ»Proximity ã«å¯¾å¿œï¼ˆRepetition ã¯å®ˆã‚Šãƒ¬ãƒ³ã‚ºã®ã€Œãƒ‡ã‚¶ã‚¤ãƒ³ãƒˆãƒ¼ã‚¯ãƒ³æº–æ‹ ã€ã€Œå…±æœ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ´»ç”¨ã€ã§ã‚«ãƒãƒ¼ï¼‰ã€‚CRAP ã¯ãƒ‡ã‚¶ã‚¤ãƒ³å®Ÿè·µã®æ‰‹æ³•ï¼ˆHowï¼‰ã€ã‚²ã‚·ãƒ¥ã‚¿ãƒ«ãƒˆåŸå‰‡ãŒç†è«–çš„è£ä»˜ã‘ï¼ˆWhyï¼‰ã‚’æä¾›ã™ã‚‹ã€‚

---

## ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆ

å®Ÿè£…å‰ã«ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆï¼ˆTODO ãƒªã‚¹ãƒˆï¼‰ã‚’ä½œæˆã™ã‚‹ã€‚

ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆã«ã¯äºŒã¤ã®å½¹å‰²ãŒã‚ã‚‹:

| æ®µéš | å½¹å‰² | æ€§è³ª |
|------|------|------|
| TDD ã‚µã‚¤ã‚¯ãƒ«ä¸­ | å®Ÿè£…ã®é“æ¨™ | æ€ã„ã¤ã„ãŸé †ã«è¿½åŠ ã—ã¦ã‚ˆã„ã€‚ä»®å®Ÿè£…ã‚„ä¸‰è§’æ¸¬é‡ã®ãŸã‚ã®ãƒ†ã‚¹ãƒˆã‚‚å«ã‚€ |
| Phase å®Œäº†æ™‚ | ä»•æ§˜ã®æ–‡æ›¸åŒ– | æ­£å¸¸ç³»ãƒ»ç•°å¸¸ç³»ãƒ»å¢ƒç•Œå€¤ãŒä½“ç³»çš„ã«æ•´ç†ã•ã‚Œã€å„ãƒ†ã‚¹ãƒˆãŒç‹¬ç«‹ã—ãŸä»•æ§˜ã‚’è¡¨ç¾ã—ã¦ã„ã‚‹ |

TDD ã‚µã‚¤ã‚¯ãƒ«ä¸­ã¯ãƒªã‚¹ãƒˆã‚’è‡ªç”±ã«ä½¿ã„ã€Phase å®Œäº†æ™‚ã«å“è³ªä¿è¨¼ã®è¦³ç‚¹ã§æ•´ç†ã™ã‚‹ï¼ˆå¾Œè¿°ã®ã€Œãƒ†ã‚¹ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ã‚’å‚ç…§ï¼‰ã€‚

### æ“ä½œãƒ‘ã‚¹ã®åˆ—æŒ™ï¼ˆãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆä½œæˆã®å‰ã«ï¼‰

ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆã‚’ä½œæˆã™ã‚‹å‰ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œãƒ‘ã‚¹ã‚’åˆ—æŒ™ã™ã‚‹ã€‚ãƒ†ã‚¹ãƒˆè¨­è¨ˆã¯ã€Œå®Ÿè£…ã®æ§‹é€ ã€ï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€é–¢æ•°ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼‰ã§ã¯ãªãã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œãƒ‘ã‚¹ã€ã‹ã‚‰å‡ºç™ºã™ã‚‹ã€‚

â†’ æ‰‹é †ã®è©³ç´°: [AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ](../../../.claude/rules/dev-flow-tdd.md#æ“ä½œãƒ‘ã‚¹ã®åˆ—æŒ™)

æ³¨: æ“ä½œãƒ‘ã‚¹ã®åˆ†é¡ï¼ˆæ­£å¸¸ç³»ãƒ»æº–æ­£å¸¸ç³»ãƒ»ç•°å¸¸ç³»ï¼‰ã¯æ—¥æœ¬ã® IT ç¾å ´ã§ã®æ…£ç”¨åˆ†é¡ã€‚ISTQB ã§ã¯ positive testing / negative testing ã® 2 åˆ†é¡ã€‚

#### è¨ˆç”»ãƒ•ã‚¡ã‚¤ãƒ«ç”¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

```markdown
#### æ“ä½œãƒ‘ã‚¹

| # | æ“ä½œãƒ‘ã‚¹ | åˆ†é¡ | ãƒ†ã‚¹ãƒˆå±¤ |
|---|---------|------|---------|
| 1 | ãƒ­ã‚°ã‚¤ãƒ³ã«æˆåŠŸã™ã‚‹ | æ­£å¸¸ç³» | E2E |
| 2 | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã‚‹å ´åˆã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ | æº–æ­£å¸¸ç³» | E2E |
| 3 | å­˜åœ¨ã—ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ | æº–æ­£å¸¸ç³» | API |
| 4 | API ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ãŸå ´åˆã€ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ | ç•°å¸¸ç³» | E2E |
```

æ“ä½œãƒ‘ã‚¹ãŒä¸è¦ãª Phase ã¯ã€Œæ“ä½œãƒ‘ã‚¹: è©²å½“ãªã—ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã®ã¿ï¼‰ã€ã¨æ˜ç¤ºã™ã‚‹ã€‚

### ãƒ†ã‚¹ãƒˆè¨­è¨ˆã®æ–¹å‘æ€§

ãƒ†ã‚¹ãƒˆè¨­è¨ˆã¯ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ï¼ˆæ“ä½œãƒ‘ã‚¹ â†’ ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆï¼‰ã§è¡Œã„ã€ãƒ†ã‚¹ãƒˆå®Ÿè£…ã¯ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—ï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆ â†’ API â†’ E2Eï¼‰ã§è¡Œã†ã€‚

```
è¨­è¨ˆï¼ˆãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ï¼‰:  æ“ä½œãƒ‘ã‚¹ â†’ ãƒ†ã‚¹ãƒˆå±¤ã®é…ç½® â†’ ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆ
å®Ÿè£…ï¼ˆãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—ï¼‰:  ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ â†’ ãƒãƒ³ãƒ‰ãƒ©ãƒ†ã‚¹ãƒˆ â†’ API ãƒ†ã‚¹ãƒˆ â†’ E2E ãƒ†ã‚¹ãƒˆ
```

è¨­è¨ˆã¨å®Ÿè£…ã®æ–¹å‘ãŒé€†ã§ã‚ã‚‹ã“ã¨ã‚’æ„è­˜ã™ã‚‹ã€‚è¨­è¨ˆæ™‚ã«ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—ã§è€ƒãˆã‚‹ã¨ã€å€‹ã€…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆã«é›†ä¸­ã—ã‚„ã™ãã€æ“ä½œãƒ‘ã‚¹å…¨ä½“ã®æ¤œè¨¼ãŒæ¼ã‚Œã‚‹ã€‚

### ä½œæˆã®ã‚³ãƒ„

1. **æ“ä½œãƒ‘ã‚¹ã‹ã‚‰é€†ç®—:** æ“ä½œãƒ‘ã‚¹ã®å„ã‚¹ãƒ†ãƒƒãƒ—ã‚’ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã«åˆ†è§£
2. **æ­£å¸¸ç³» â†’ æº–æ­£å¸¸ç³» â†’ ç•°å¸¸ç³»:** ã¾ãšæˆåŠŸãƒ‘ã‚¹ã€æ¬¡ã«è¨­è¨ˆã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼å‡¦ç†ã€æœ€å¾Œã«æƒ³å®šå¤–ã®éšœå®³
3. **å¢ƒç•Œå€¤:** ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã‚’å¿˜ã‚Œãšã«
4. **ãƒ†ã‚¹ãƒˆå±¤ã®é…ç½®:** æ“ä½œãƒ‘ã‚¹ã®æ€§è³ªã«å¿œã˜ã¦é©åˆ‡ãªãƒ†ã‚¹ãƒˆå±¤ã«é…ç½®

### ãƒ†ã‚¹ãƒˆå±¤ã®æ˜è¨˜

ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆã«ã¯ã€ãƒ†ã‚¹ãƒˆãƒ”ãƒ©ãƒŸãƒƒãƒ‰ã®å„å±¤ã‚’æ˜è¨˜ã™ã‚‹ã€‚ãƒ†ã‚¹ãƒˆå±¤ã®é¸æŠã¯è¨­è¨ˆåˆ¤æ–­ã§ã‚ã‚Šã€è¨ˆç”»ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆæ™‚ï¼ˆè¨­è¨ˆæ®µéšï¼‰ã§æ¤œè¨ã™ã‚‹ã€‚

â†’ æ‰‹é †ã®è©³ç´°: [AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ](../../../.claude/rules/dev-flow-tdd.md#ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆ)
â†’ è¨ˆç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®å¿…é ˆè¦ç´ : [zoom-rhythm.md > ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆ](../../../.claude/rules/zoom-rhythm.md#ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆå„-phase)

### ä¾‹: ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½

```markdown
## æ“ä½œãƒ‘ã‚¹

| # | æ“ä½œãƒ‘ã‚¹ | åˆ†é¡ | ãƒ†ã‚¹ãƒˆå±¤ |
|---|---------|------|---------|
| 1 | ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã‹ã‚‰ãƒ­ã‚°ã‚¤ãƒ³æ“ä½œã‚’å®Œäº†ã§ãã‚‹ | æ­£å¸¸ç³» | E2E + API + ãƒ¦ãƒ‹ãƒƒãƒˆ |
| 2 | ä¸æ­£ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ | æº–æ­£å¸¸ç³» | E2E + API + ãƒ¦ãƒ‹ãƒƒãƒˆ |
| 3 | å­˜åœ¨ã—ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ | æº–æ­£å¸¸ç³» | API + ãƒ¦ãƒ‹ãƒƒãƒˆ |
| 4 | éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒ­ã‚°ã‚¤ãƒ³ãŒæ‹’å¦ã•ã‚Œã‚‹ | æº–æ­£å¸¸ç³» | ãƒ¦ãƒ‹ãƒƒãƒˆ |

## ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆ

### Phase 1: UserRepository / PasswordHasher

æ“ä½œãƒ‘ã‚¹: è©²å½“ãªã—ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã®ã¿ï¼‰

ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ:
- [ ] ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å–å¾—ã§ãã‚‹ï¼ˆæ“ä½œãƒ‘ã‚¹ #1 ã®ä¸‹ä½å±¤ï¼‰
- [ ] å­˜åœ¨ã—ãªã„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å ´åˆ None ã‚’è¿”ã™ï¼ˆæ“ä½œãƒ‘ã‚¹ #3 ã®ä¸‹ä½å±¤ï¼‰
- [ ] åˆ¥ãƒ†ãƒŠãƒ³ãƒˆã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å–å¾—ã§ããªã„
- [ ] ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ¤œè¨¼ã§ãã‚‹ï¼ˆæ­£ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰ï¼ˆæ“ä½œãƒ‘ã‚¹ #1 ã®ä¸‹ä½å±¤ï¼‰
- [ ] ä¸æ­£ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯æ¤œè¨¼å¤±æ•—ï¼ˆæ“ä½œãƒ‘ã‚¹ #2 ã®ä¸‹ä½å±¤ï¼‰

ãƒãƒ³ãƒ‰ãƒ©ãƒ†ã‚¹ãƒˆï¼ˆè©²å½“ãªã—ï¼‰
API ãƒ†ã‚¹ãƒˆï¼ˆè©²å½“ãªã—ï¼‰
E2E ãƒ†ã‚¹ãƒˆï¼ˆè©²å½“ãªã—ï¼‰

### Phase 2: AuthUseCase

æ“ä½œãƒ‘ã‚¹: è©²å½“ãªã—ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã®ã¿ï¼‰

ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ:
- [ ] æ­£ã—ã„èªè¨¼æƒ…å ±ã§ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹ï¼ˆæ“ä½œãƒ‘ã‚¹ #1 ã®ä¸‹ä½å±¤ï¼‰
- [ ] ä¸æ­£ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ï¼ˆæ“ä½œãƒ‘ã‚¹ #2 ã®ä¸‹ä½å±¤ï¼‰
- [ ] å­˜åœ¨ã—ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ï¼ˆæ“ä½œãƒ‘ã‚¹ #3 ã®ä¸‹ä½å±¤ï¼‰
- [ ] éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ­ã‚°ã‚¤ãƒ³ä¸å¯ï¼ˆæ“ä½œãƒ‘ã‚¹ #4ï¼‰

ãƒãƒ³ãƒ‰ãƒ©ãƒ†ã‚¹ãƒˆï¼ˆè©²å½“ãªã—ï¼‰
API ãƒ†ã‚¹ãƒˆï¼ˆè©²å½“ãªã—ï¼‰
E2E ãƒ†ã‚¹ãƒˆï¼ˆè©²å½“ãªã—ï¼‰

### Phase 3: Core Service Handler / BFF Handler

ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ:
- [ ] SessionManager: ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆã§ãã‚‹
- [ ] SessionManager: ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å–å¾—ã§ãã‚‹
- [ ] SessionManager: ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å‰Šé™¤ã§ãã‚‹
- [ ] SessionManager: å­˜åœ¨ã—ãªã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯ None ã‚’è¿”ã™

ãƒãƒ³ãƒ‰ãƒ©ãƒ†ã‚¹ãƒˆ:
- [ ] Core Service: æ­£ã—ã„èªè¨¼æƒ…å ±ã§ 200 ã‚’è¿”ã™ï¼ˆæ“ä½œãƒ‘ã‚¹ #1ï¼‰
- [ ] Core Service: ä¸æ­£ãªèªè¨¼æƒ…å ±ã§ 401 ã‚’è¿”ã™ï¼ˆæ“ä½œãƒ‘ã‚¹ #2, #3ï¼‰
- [ ] BFF: ã‚»ãƒƒã‚·ãƒ§ãƒ³ Cookie ã‚’è¨­å®šã™ã‚‹ï¼ˆæ“ä½œãƒ‘ã‚¹ #1ï¼‰
- [ ] BFF: ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢ãŒæ©Ÿèƒ½ã™ã‚‹

API ãƒ†ã‚¹ãƒˆ:
- [ ] POST /api/v1/auth/login ã§èªè¨¼æˆåŠŸï¼ˆæ“ä½œãƒ‘ã‚¹ #1ï¼‰
- [ ] POST /api/v1/auth/login ã§èªè¨¼å¤±æ•—ï¼ˆæ“ä½œãƒ‘ã‚¹ #2ï¼‰

E2E ãƒ†ã‚¹ãƒˆ:
- [ ] ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã‹ã‚‰ãƒ­ã‚°ã‚¤ãƒ³æ“ä½œã‚’å®Œäº†ã§ãã‚‹ï¼ˆæ“ä½œãƒ‘ã‚¹ #1ï¼‰
- [ ] ä¸æ­£ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼ˆæ“ä½œãƒ‘ã‚¹ #2ï¼‰
```

### é€²ã‚æ–¹

1. ãƒªã‚¹ãƒˆã®æœ€åˆã®é …ç›®ã‚’é¸ã¶
2. Red â†’ Green â†’ Refactor
3. å®Œäº†ã—ãŸã‚‰ãƒã‚§ãƒƒã‚¯ã‚’ä»˜ã‘ã‚‹ âœ…
4. æ¬¡ã®é …ç›®ã¸
5. æ–°ã—ã„ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’æ€ã„ã¤ã„ãŸã‚‰ãƒªã‚¹ãƒˆã«è¿½åŠ 

---

## MVP ç©ã¿ä¸Šã’æ–¹å¼

ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«çš„ã«ã€å‹•ãæœ€å°å˜ä½ã‹ã‚‰æ®µéšçš„ã«æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã€‚

â†’ æ‰‹é †ã®è©³ç´°: [AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ](../../../.claude/rules/dev-flow-tdd.md#mvp-ç©ã¿ä¸Šã’æ–¹å¼)

### ä¾å­˜é–¢ä¿‚ã‚’è€ƒæ…®ã—ãŸé †åºï¼ˆä¾‹ï¼‰

```mermaid
flowchart TB
    subgraph Layer1["Layer 1: ã‚¤ãƒ³ãƒ•ãƒ©"]
        A["UserRepository"]
        B["PasswordHasher"]
        C["SessionManager"]
    end

    subgraph Layer2["Layer 2: ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹"]
        D["AuthUseCase"]
    end

    subgraph Layer3["Layer 3: API"]
        E["Core Service Handler"]
        F["BFF Handler"]
    end

    A --> D
    B --> D
    D --> E
    C --> F
    E --> F
```

**å®Ÿè£…é †åº:**
1. UserRepositoryï¼ˆDB ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ï¼‰
2. PasswordHasherï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¤œè¨¼ï¼‰
3. AuthUseCaseï¼ˆèªè¨¼ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
4. Core Service Handlerï¼ˆå†…éƒ¨ APIï¼‰
5. SessionManagerï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼‰
6. BFF Handlerï¼ˆå…¬é–‹ APIï¼‰

å„ã‚¹ãƒ†ãƒƒãƒ—ã§ã€Œãƒ†ã‚¹ãƒˆ â†’ å®Ÿè£… â†’ ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã€ã‚’ç¹°ã‚Šè¿”ã™ã€‚

### ãƒ†ã‚¹ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆPhase å®Œäº†æ™‚ï¼‰

å„ Phase ã® TDD ã‚µã‚¤ã‚¯ãƒ«å®Œäº†å¾Œã€ãƒ†ã‚¹ãƒˆã‚’å“è³ªä¿è¨¼ã®è¦³ç‚¹ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹ã€‚

â†’ æ‰‹é †ã®è©³ç´°: [AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ](../../../.claude/rules/dev-flow-tdd.md#ãƒ†ã‚¹ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼phase-å®Œäº†æ™‚)

TDD ã‚µã‚¤ã‚¯ãƒ«ä¸­ã® Refactor ã¯ãƒ†ã‚¹ãƒˆã®å±€æ‰€çš„ãªæ”¹å–„ã€‚ãƒ†ã‚¹ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯ Phase å…¨ä½“ã‚’ä¿¯ç°ã—ãŸæ•´ç†ã€‚

---

## å®Ÿè·µçš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: ä¸‰è§’æ¸¬é‡ï¼ˆTriangulationï¼‰

1ã¤ã®ãƒ†ã‚¹ãƒˆã ã‘ã§ã¯ä¸€èˆ¬åŒ–ã—ã«ãã„å ´åˆã€è¤‡æ•°ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ ã—ã¦å®Ÿè£…ã‚’å°ãã€‚

```rust
// ãƒ†ã‚¹ãƒˆ1
#[test]
fn test_verify_password_returns_true_for_correct_password() {
    let hasher = Argon2PasswordHasher::new();
    let hash = hasher.hash("password123").unwrap();
    assert!(hasher.verify("password123", &hash).unwrap());
}

// ãƒ†ã‚¹ãƒˆ2ï¼ˆä¸‰è§’æ¸¬é‡ï¼‰
#[test]
fn test_verify_password_returns_false_for_wrong_password() {
    let hasher = Argon2PasswordHasher::new();
    let hash = hasher.hash("password123").unwrap();
    assert!(!hasher.verify("wrongpassword", &hash).unwrap());
}
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: Given-When-Thenï¼ˆAAAï¼‰

ãƒ†ã‚¹ãƒˆã®æ§‹é€ ã‚’æ˜ç¢ºã«ã™ã‚‹ã€‚

```rust
#[tokio::test]
async fn test_login_succeeds_with_valid_credentials() {
    // Givenï¼ˆArrangeï¼‰: å‰ææ¡ä»¶
    let repo = FakeUserRepository::new();
    let hasher = FakePasswordHasher::new();
    let sut = AuthUseCase::new(repo, hasher);

    // Whenï¼ˆActï¼‰: å®Ÿè¡Œ
    let result = sut.authenticate(&email, &password).await;

    // Thenï¼ˆAssertï¼‰: æ¤œè¨¼
    assert!(result.is_ok());
}
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: ãƒ†ã‚¹ãƒˆãƒ€ãƒ–ãƒ«

ä¾å­˜ã‚’å·®ã—æ›¿ãˆã¦å˜ä½“ãƒ†ã‚¹ãƒˆã‚’å¯èƒ½ã«ã™ã‚‹ã€‚

| ç¨®é¡ | ç”¨é€” |
|------|------|
| Stub | å›ºå®šå€¤ã‚’è¿”ã™ |
| Mock | å‘¼ã³å‡ºã—ã‚’æ¤œè¨¼ |
| Fake | ç°¡æ˜“ç‰ˆã®å®Ÿè£…ï¼ˆã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªDBãªã©ï¼‰ |

```rust
// Fake å®Ÿè£…ã®ä¾‹
pub struct InMemoryUserRepository {
    users: HashMap<Email, User>,
}

impl UserRepository for InMemoryUserRepository {
    async fn find_by_email(&self, _tenant_id: &TenantId, email: &Email) -> Result<Option<User>> {
        Ok(self.users.get(email).cloned())
    }
}
```

---

## ãƒ†ã‚¹ãƒˆè¦ç´„

### ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®å‘½å: `sut`

ãƒ†ã‚¹ãƒˆå¯¾è±¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å¤‰æ•°åã«ã¯ `sut`ï¼ˆSystem Under Testï¼‰ã‚’ä½¿ç”¨ã™ã‚‹ã€‚

â†’ æ‰‹é †ã®è©³ç´°: [AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ](../../../.claude/rules/dev-flow-tdd.md#sut-å‘½å)

å‡ºå…¸: Gerard Meszarosã€xUnit Test Patternsã€ï¼ˆAddison-Wesley, 2007ï¼‰ã§ä½“ç³»åŒ–ã•ã‚ŒãŸç”¨èªã€‚C#/Java åœã§åºƒãæµ¸é€ã—ã¦ã„ã‚‹ã€‚

---

## ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å…¨ä½“åƒ

```mermaid
flowchart TD
    A["Issue ã®å®Œäº†åŸºæº–ã‚’ç¢ºèª"] --> OP["æ“ä½œãƒ‘ã‚¹ã‚’åˆ—æŒ™"]
    OP --> B["ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆã‚’ä½œæˆ"]
    B --> V["ç¢ºèªäº‹é …ã‚’å®Ÿæ–½"]
    V --> C["æœ€åˆã®ãƒ†ã‚¹ãƒˆã‚’é¸æŠ"]
    C --> D["ğŸ”´ Red: ãƒ†ã‚¹ãƒˆã‚’æ›¸ã"]
    D --> E["ğŸŸ¢ Green: å®Ÿè£…ã™ã‚‹"]
    E --> F["ğŸ”µ Refactor: æ•´ç†ã™ã‚‹"]
    F --> G{"ãƒ†ã‚¹ãƒˆãƒªã‚¹ãƒˆ<br/>å®Œäº†ï¼Ÿ"}
    G -->|No| C
    G -->|Yes| H["çµ±åˆãƒ†ã‚¹ãƒˆã§å‹•ä½œç¢ºèª"]
    H --> J["just check<br/>ï¼ˆlint + ãƒ†ã‚¹ãƒˆ + çµ±åˆãƒ†ã‚¹ãƒˆï¼‰"]
    J --> I["PR ä½œæˆ"]
```

---

## E2E ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°

E2E ãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰ã¯ TDD ã® Red-Green-Refactor ã‚µã‚¤ã‚¯ãƒ«ã«ã¯çµ„ã¿è¾¼ã¾ãªã„ã€‚

| ç†ç”± | èª¬æ˜ |
|------|------|
| å®Ÿè¡Œé€Ÿåº¦ | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ + ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®èµ·å‹•ãŒå¿…è¦ã§ã€ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã¨æ¯”ã¹å¤§å¹…ã«é…ã„ |
| TDD ã®æœ¬è³ª | TDD ã¯é«˜é€Ÿãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—ã€‚E2E ãƒ†ã‚¹ãƒˆã®é…ã•ã¯ã“ã®ãƒªã‚ºãƒ ã‚’å´©ã™ |
| è²¬å‹™ã®åˆ†é›¢ | E2E ã¯ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã®å®Œçµæ€§ã€ã‚’æ¤œè¨¼ã™ã‚‹å“è³ªã‚²ãƒ¼ãƒˆã§ã‚ã‚Šã€è¨­è¨ˆã‚’é§†å‹•ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã¯ãªã„ |

â†’ æ‰‹é †ã®è©³ç´°: [AI ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆ](../../../.claude/rules/dev-flow-tdd.md#e2e-ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°)
â†’ E2E ãƒ†ã‚¹ãƒˆã®è©³ç´°: [Playwright ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹](../../../docs/80_ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹/devtools/Playwright.md)
â†’ E2E ãƒ†ã‚¹ãƒˆã®ãƒ«ãƒ¼ãƒ«: [`.claude/rules/e2e-test.md`](../../../.claude/rules/e2e-test.md)

---

## å‚è€ƒè³‡æ–™

- ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€Kent Beck è‘—ã€å’Œç”°å“äºº è¨³
- t_wada ã®ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ»è¬›æ¼”è³‡æ–™
- [ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã¿ãŸ](https://qiita.com/t_wada/items/e2b3b1a5b9e89a5b7f9c)
- Robert C. Martin (2021) "Clean Craftsmanship" â€” nano-cycleï¼ˆRed å†…ã®å°ã‚µã‚¤ã‚¯ãƒ«ï¼‰
- Kent Beck (2000) "Extreme Programming Explained" â€” Four Rules of Simple Design
- Robert C. Martin (2003) "Agile Software Development, Principles, Patterns, and Practices" â€” SOLID åŸå‰‡
- Steve Freeman & Nat Pryce (2009) "Growing Object-Oriented Software, Guided by Tests" â€” "Write the test you wish you had"
- Yaron Minsky (2011) "Effective ML" â€” Making Illegal States Unrepresentable
- Alexis King (2019) "Parse, don't validate"
- Robin Williams (2004) "The Non-Designer's Design Book" (CRAP åŸå‰‡)

### æ—¢çŸ¥æ‰‹æ³•ã¨ã®å¯¾å¿œ

| æ¦‚å¿µ | å‡ºå…¸ | æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã®å¯¾å¿œ |
|------|------|---------------------|
| Four Rules of Simple Design | Kent Beck, *Extreme Programming Explained* (2000) | æ¯ Refactor ãƒ¬ãƒ³ã‚ºï¼ˆæ„å›³ã®æ˜ç¢ºã•ãƒ»é‡è¤‡ã®æ’é™¤ãƒ»è¦ç´ ã®æœ€å°æ€§ï¼‰ |
| SRPãƒ»DIPï¼ˆSOLID åŸå‰‡ï¼‰ | Robert C. Martin, *Agile Software Development* (2003) | ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å®Œæˆæ™‚ãƒ¬ãƒ³ã‚ºï¼ˆå˜ä¸€è²¬å‹™ãƒ»ä¾å­˜æ–¹å‘ï¼‰ |
| Making Illegal States Unrepresentable | Yaron Minsky, *Effective ML* (2011); Richard Feldman, *Elm Conf* (2016) | å‹ã®æ´»ç”¨ãƒ¬ãƒ³ã‚ºï¼ˆNewtypeã€å‹å®‰å…¨ã‚¹ãƒ†ãƒ¼ãƒˆãƒã‚·ãƒ³ã€æ§‹é€ çš„å¼·åˆ¶ï¼‰ |
| Parse, don't validate | Alexis King (2019) | å‹ã®æ´»ç”¨ãƒ¬ãƒ³ã‚ºï¼ˆå¢ƒç•Œã§ã®å‹å¤‰æ›ã€ä¸å¤‰æ¡ä»¶ã®ä¿è­·ï¼‰ |
| nano-cycleï¼ˆRed å†…ã®å°ã‚µã‚¤ã‚¯ãƒ«ï¼‰ | Robert C. Martin, *Clean Craftsmanship* (2021) | äºŒå±¤ã® Red ãƒ¢ãƒ‡ãƒ« |
| Compiler-Driven Development | é™çš„å‹ä»˜ãè¨€èª TDD ã®ä¸€èˆ¬çš„ãªè€ƒãˆæ–¹ | ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼è§£æ¶ˆã®åŸå‰‡ |
| "Write the test you wish you had" | Freeman & Pryce, *GOOS* (2009) | Red ãƒ•ã‚§ãƒ¼ã‚ºã®ã€Œãƒ†ã‚¹ãƒˆã‚’1ã¤ã ã‘æ›¸ãã€ |
| Usability Heuristics | Jakob Nielsen, *10 Usability Heuristics for User Interface Design* (1994, 2024 æ›´æ–°) | UI/UX ãƒ¬ãƒ³ã‚ºï¼ˆH1, H3, H4, H5, H8, H9ï¼‰ |
| POUR åŸå‰‡ | W3C, *WCAG 2.1* (2018) | ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ¬ãƒ³ã‚ºï¼ˆPerceivable + Operableï¼‰ |
| CRAP åŸå‰‡ | Robin Williams, *The Non-Designer's Design Book* (2004) | ãƒ‡ã‚¶ã‚¤ãƒ³å“è³ªå‘ä¸Šãƒ¬ãƒ³ã‚ºï¼ˆC: ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã®åŠ¹æœã€A: æ•´åˆ—ã®ä¸€è²«æ€§ã€P: ä½™ç™½ã®æ´»ç”¨ï¼‰ã€‚R ã¯å®ˆã‚Šãƒ¬ãƒ³ã‚ºã§ã‚«ãƒãƒ¼ |

â†’ è©³ç´°: [ç‹¬è‡ªãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨æ—¢çŸ¥æ‰‹æ³•ã®å¯¾å¿œ](../../80_ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹/methodology/ç‹¬è‡ªãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨æ—¢çŸ¥æ‰‹æ³•ã®å¯¾å¿œ.md)


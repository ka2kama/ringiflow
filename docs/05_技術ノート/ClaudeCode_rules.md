# Claude Code rules

## 概要

`.claude/rules/` は Claude Code のルール管理機能。
プロジェクト固有の指示をモジュール化し、特定のファイルパターンに対してのみ適用できる。

## CLAUDE.md との違い

| 観点 | CLAUDE.md | .claude/rules/ |
|------|-----------|----------------|
| 形式 | 単一ファイル | 複数ファイル（モジュール化） |
| 適用範囲 | 常に全体 | paths 指定で限定可能 |
| 用途 | プロジェクト全体のコアルール | ファイルタイプ別・機能別のルール |
| スケール | 小〜中規模 | 中〜大規模 |
| 優先度 | 同じ | 同じ |

## 使い方

### ディレクトリ構造

```
.claude/
├── settings.json
└── rules/
    ├── docs.md           # ドキュメント規約
    ├── testing.md        # テスト規約
    ├── frontend/
    │   └── elm.md        # Elm 固有ルール
    └── backend/
        └── rust.md       # Rust 固有ルール
```

サブディレクトリで階層化可能（深さ制限なし）。

### paths 指定（条件付きルール）

YAML フロントマターで `paths` を指定すると、マッチするファイル編集時のみ適用される。

```markdown
---
paths:
  - "docs/**/*.md"
---

# ドキュメント規約

- Mermaid 記法を使用
- 連番プレフィックス: `00_`, `01_`, ...
```

### Glob パターン

| パターン | 対象 |
|---------|------|
| `**/*.rs` | あらゆるディレクトリの Rust ファイル |
| `src/**/*` | `src/` 以下のすべてのファイル |
| `*.md` | プロジェクトルートの Markdown ファイル |
| `**/*.{ts,tsx}` | `.ts` と `.tsx` ファイル（ブレース展開） |
| `{src,lib}/**/*.rs` | 複数ディレクトリの指定 |

### 無条件ルール

`paths` を省略すると、すべてのファイルに適用される（CLAUDE.md と同じ挙動）。

```markdown
# セキュリティルール

- 秘匿情報をコードにハードコードしない
- SQL インジェクション対策を徹底
```

## 適用優先度

1. プロジェクトルールが最優先
2. ユーザーレベルルール（`~/.claude/rules/`）は低優先
3. `paths` なしのルールはすべてのファイルに適用
4. `paths` ありのルールはマッチするファイルにのみ適用

## 使い分けガイドライン

### CLAUDE.md に書くべきもの

- プロジェクト概要、技術スタック
- コアバリュー、理念
- ドキュメント体系の説明
- 全ての作業に適用されるルール

### rules/ に書くべきもの

- 言語固有のコーディング規約
- ドキュメント固有のフォーマット規約
- テスト固有のルール
- 特定ディレクトリにのみ適用されるルール

### 判断基準

```
すべてのファイルに適用?
├── Yes → CLAUDE.md
└── No  → .claude/rules/ + paths 指定
```

## 関連リソース

- [Claude Code Memory Management](https://docs.anthropic.com/en/docs/claude-code/memory)
- [CLAUDE.md](../../CLAUDE.md)

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2026-01-14 | 初版作成 |

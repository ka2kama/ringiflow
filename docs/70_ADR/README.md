# Architecture Decision Records (ADR)

## 概要

ADR は、アーキテクチャ上の重要な決定とその背景を記録するドキュメントです。
「なぜその決定をしたのか」を将来の開発者（および AI エージェント）が理解できるよう、形式知として残します。

## ADR の目的

- 意思決定の追跡可能性: なぜその設計・技術選定になったかを記録
- 暗黙知の排除: 「昔からこうだった」を防ぎ、根拠を明示
- オンボーディング支援: 新規参画者がプロジェクトの経緯を把握
- 再検討の基盤: 状況が変わった際に、元の決定を見直す判断材料

## ADR とその他ドキュメントの役割分担

| ドキュメント種別 | 問い | 内容 | 更新頻度 |
|-----------------|------|------|---------|
| 要件定義書 | WHAT | 何を作るか | 要件変更時 |
| 設計書 | HOW | どう作るか | 実装変更時 |
| ADR | WHY | なぜその決定か | 原則不変 |
| 手順書 | HOW TO | どう操作するか | 手順変更時 |

## ADR のライフサイクル

```
提案 → 承認済み → [廃止]
         ↓
      [置換] → 新しい ADR
```

### ステータス定義

| ステータス | 説明 |
|-----------|------|
| 提案 | レビュー中、まだ決定していない |
| 承認済み | 決定済み、プロジェクトで適用中 |
| 廃止 | 状況変化により無効、別の ADR で置換 |

## ADR の書き方

### ファイル命名規則

```
NNN_決定内容の要約.md
```

- `NNN`: 3桁の連番（001, 002, ...）
- 決定内容: 簡潔な日本語（スネークケース不要）

例:
- `001_ID形式の選定.md`
- `002_認証方式の選定.md`
- `003_フロントエンドフレームワークの選定.md`

### 必須セクション

1. ステータス: 現在の状態と日付
2. コンテキスト: 決定が必要になった背景・課題
3. 検討した選択肢: 比較した代替案とその評価
4. 決定: 何を選び、なぜ選んだか
5. 帰結: この決定による影響（正負両面）

### テンプレート

`template.md` を参照してください。

## ADR を書くべきタイミング

以下のような決定を行う際に ADR を作成します:

- 技術スタック・フレームワークの選定
- アーキテクチャパターンの採用（CQRS, Event Sourcing 等）
- データ形式・プロトコルの選定（ID 形式、API 形式等）
- 認証・認可方式の選定
- インフラ構成の決定
- 重要なトレードオフを伴う設計判断

## ADR を書かなくてよいケース

- 実装の詳細（設計書で記述）
- 一時的な回避策（Issue/PR で記録）
- 業界標準に従うだけの決定（明示する価値がない）

## 既存 ADR の変更

### 原則: ADR は不変

一度承認された ADR は原則として変更しません。
誤字脱字の修正を除き、内容の変更は避けてください。

### 決定を変更する場合

1. 元の ADR を「廃止」または「置換」ステータスに変更
2. 新しい ADR を作成し、元の ADR への参照を含める
3. 新しい ADR に変更理由を明記

```markdown
## ステータス
承認済み（2026-03-15）

置換対象: [ADR-001](001_ID形式の選定.md)
```

## ADR 一覧

ディレクトリ内のファイルを参照してください:

```bash
ls docs/70_ADR/*.md
```

ファイル名は `NNN_タイトル.md` 形式で、番号順にソートされます。

---

## 参考資料

- [Documenting Architecture Decisions - Michael Nygard](https://cognitect.com/blog/2011/11/15/documenting-architecture-decisions)
- [ADR GitHub Organization](https://adr.github.io/)

# ADR-027: Tailwind CSS 導入

## ステータス

承認済み（2026-01-31）

## コンテキスト

MVP 完了後の UI/UX 改善フェーズにおいて、フロントエンドのスタイリング基盤を整備する必要がある。

現状の課題:

- Elm のインラインスタイル（`style "property" "value"`）がビュー関数を肥大化させ、可読性が低い
- CSS クラス（`class "btn btn-primary"` 等）が定義されておらず、スタイルが適用されていない
- デザイントークン（カラーパレット、スペーシング等）が統一されておらず、ハードコードされた値が散在
- レスポンシブ対応が行われていない

要件定義書 CORE-06（デザインシステム）では、一貫したデザイントークンと再利用可能な UI パターンの確立を求めている。

## 検討した選択肢

### 選択肢 1: Tailwind CSS v4 + `@tailwindcss/vite`

ユーティリティファーストの CSS フレームワーク。v4 では CSS ファースト設定（`@theme` ディレクティブ）を採用し、Vite プラグインとして直接統合可能。

評価:
- 利点:
  - CSS ファースト設定により `tailwind.config.js` が不要、CSS 内でデザイントークンを完結できる
  - `@tailwindcss/vite` プラグインで PostCSS 不要、ビルドパイプラインがシンプル
  - Rust ベースの Lightning CSS エンジンで高速ビルド
  - ユーティリティクラスの組み合わせで宣言的にスタイルを表現でき、Elm のアプローチと親和性が高い
  - ソースファイルの自動スキャン（`content` 設定不要）
- 欠点:
  - Elm の型安全性がスタイリングには及ばない（クラス名は文字列）
  - 長いクラス文字列がビュー関数内で目立つ
  - v4 は比較的新しく、v3 からの移行情報が主流

### 選択肢 2: Tailwind CSS v3

安定版の Tailwind CSS。`tailwind.config.js` + PostCSS による設定。

評価:
- 利点:
  - 成熟したエコシステム、豊富なドキュメント・プラグイン
  - 採用実績が豊富
- 欠点:
  - PostCSS 設定が必要でビルドパイプラインが複雑化
  - `tailwind.config.js` + `postcss.config.js` の 2 ファイルが必要
  - `content` パスの手動設定が必要
  - v4 が安定版としてリリース済みのため、あえて旧バージョンを選ぶ理由がない

### 選択肢 3: elm-css

Elm の型システムを活用した CSS ライブラリ。スタイルを Elm の型として表現する。

評価:
- 利点:
  - 型安全な CSS（無効なプロパティ値をコンパイル時に検出）
  - Elm のエコシステムに完全に統合
- 欠点:
  - レスポンシブデザインやユーティリティパターンのサポートが限定的
  - デザイントークンの管理が独自実装になる
  - コミュニティが小さく、メンテナンス状況に不安
  - 学習コストが高い割に、実用上の型安全性メリットがインラインスタイルに対して限定的

### 選択肢 4: Plain CSS + BEM

CSS ファイルに BEM 命名規則でクラスを定義する伝統的アプローチ。

評価:
- 利点:
  - 依存ライブラリなし、最もシンプル
  - CSS の基礎を深く学べる
- 欠点:
  - デザイントークンの一元管理が困難（CSS カスタムプロパティで部分的に対応可能だが体系化が手動）
  - レスポンシブ対応のメディアクエリ管理が煩雑
  - 命名の一貫性維持にチーム規約が必要
  - 未使用 CSS の検出・削除が困難

### 比較表

| 観点 | Tailwind v4 | Tailwind v3 | elm-css | Plain CSS + BEM |
|------|------------|------------|---------|----------------|
| ビルド設定の簡潔さ | ◎ Vite プラグイン直接 | △ PostCSS 経由 | ○ Elm 内で完結 | ◎ 設定不要 |
| デザイントークン管理 | ◎ `@theme` | ○ config.js | △ 独自実装 | △ 手動管理 |
| レスポンシブ対応 | ◎ `sm:`, `lg:` 等 | ◎ 同上 | △ 手動 | △ メディアクエリ手動 |
| 型安全性 | × 文字列ベース | × 文字列ベース | ◎ Elm 型 | × 文字列ベース |
| 学習効果 | ○ 業界標準の知識 | ○ 同上 | △ Elm 固有 | ○ CSS 基礎 |
| エコシステム成熟度 | ○ v4 安定版 | ◎ 豊富な実績 | △ 小規模 | ◎ 標準技術 |

## 決定

**Tailwind CSS v4 + `@tailwindcss/vite`** を採用する。

主な理由:

1. Vite との直接統合により、ビルドパイプラインがシンプルに保てる（PostCSS 不要）
2. `@theme` ディレクティブでデザイントークンを CSS カスタムプロパティとして定義でき、将来のダークモード対応にも対応しやすい
3. ユーティリティファーストの宣言的アプローチが Elm の関数型スタイルと親和性が高い
4. 業界標準の知識が身につき、学習効果が高い（プロジェクト理念 1 に合致）

型安全性の欠如（文字列ベースのクラス名）については、コンポーネント境界（ページモジュール）でパターンを統一し、視覚的なレビューで品質を担保する。elm-css の型安全性は魅力的だが、レスポンシブ対応の弱さとエコシステムの小ささがより大きなリスクと判断した。

## 帰結

### 肯定的な影響

- デザイントークンが `styles.css` の `@theme` に一元化され、カラーパレットの一貫性が保証される
- レスポンシブレイアウト（サイドバー + コンテンツ）が `lg:` プレフィックスで宣言的に実現できる
- インラインスタイルの排除によりビュー関数の可読性が向上
- Tailwind の tree-shaking により、使用クラスのみがバンドルに含まれる

### 否定的な影響・トレードオフ

- クラス名が文字列であるため、タイポがランタイムまで検出されない
- 長いクラス文字列がビュー関数に現れ、HTML 構造が見づらくなる場合がある
- `elm/svg` パッケージへの新規依存が追加される（サイドバーアイコン用）

### 関連ドキュメント

- 要件定義書: CORE-06（デザインシステム）
- 実装: `frontend/src/styles.css`（デザイントークン定義）
- 実装: `frontend/vite.config.js`（`@tailwindcss/vite` プラグイン設定）

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2026-01-31 | 初版作成 |

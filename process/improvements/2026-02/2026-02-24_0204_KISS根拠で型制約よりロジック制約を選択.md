# KISS 根拠で型制約よりロジック制約を選択

## 事象

#859（型安全ステートマシン再評価）の設計フェーズで、`CancelledState` の改善候補として Candidate 1（`from_db()` に `if` 文を追加するロジックバリデーション）を Candidate 3（ADT 分離による型制約）より優先して提案した。

設計フェーズで「ロジックではなく型による制約」を採用するよう指摘を受け、Candidate 3 に変更した。

## 原因分析

- プロジェクトの設計原則「型で表現できるものは型で表現する」を認識していたが、コード変更量の少なさ（KISS）を優先して Candidate 1 を選択した
- CLAUDE.md に「YAGNI/KISS/MVP は機能スコープの原則。設計品質を妥協する根拠にしない」と明記されているにもかかわらず、KISS を設計品質の判定に適用した
- 判定基準「放置すると後続で同パターンが使われるか？」を適用していれば、ロジックバリデーションは他の箇所でも同パターンが使われるリスクがあり、型制約を選択すべきと判断できた

## 対策

- 問題の性質: 思考的

既存の設計原則（CLAUDE.md「YAGNI/KISS/MVP は機能スコープの原則」、ADR-054「型で表現できるものは型で表現する」）が適用されていれば防止できた。新たなルール追加は不要。

設計判断時に「型で表現できるか？」→「コード量は増えるが型制約の方が堅牢か？」の問いを意識すること。これは行動規範形式だが、設計ブラッシュアップループの「型の活用」観点（zoom-rhythm.md）として既にフロー組み込み済み。

## 次のアクション

なし（既存のフレームワークで対応可能）

## 分類

- カテゴリ: 知識-実行乖離
- 失敗タイプ: 実行ギャップ
- 問題の性質: 思考的

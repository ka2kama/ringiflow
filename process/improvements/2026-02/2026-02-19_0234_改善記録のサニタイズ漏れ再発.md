# 改善記録のサニタイズ漏れ再発

## 事象

改善記録「review-and-merge で複数 PR を同時処理しようとした」の事象セクションに、ユーザーの発言を直接引用した状態でコミットした。ユーザーの指摘を受けて修正した。

同種の問題は過去に 2 回発生している:

1. [改善記録にユーザー発言を直接引用した](2026-02-09_2122_改善記録にユーザー発言を直接引用した.md) — docs.md に自己チェック追加で対策済み
2. [改善記録作成時の自己チェック省略](2026-02-15_1600_改善記録作成時の自己チェック省略.md) — README.md への組み込み（Issue #550）で対策予定

## 原因分析

### Want

ドキュメントにユーザーの発言が直接引用されない状態が、チェックリストの実行有無に依存せず構造的に担保されること。

### To-Be

改善記録を含むすべての公開ドキュメントで、ユーザー発言が技術的内容に要約されている。

### As-Is

docs.md に自己チェックリストが存在するが、改善記録作成時に参照・実行されていない。3 回目の再発。

### ギャップ分析

対策が「行動規範」（自己チェックを実行すること）に留まっており、フロー組み込みや自動検証に至っていない。Issue #550 が未実装のまま。

### 根本原因

自己チェックリストは存在するが、AI がドキュメントを生成する際に自動的に実行される仕組みになっていない。行動規範形式の対策が再発を防げないことを示す典型例。

## 対策

問題の性質: プロセス的

### 暫定対策

Issue #550 の優先度を上げ、改善記録 README.md に自己チェックのリマインダーを追加する。

### 恒久対策の方向性

行動規範（自己チェックを実行する）では 3 回再発しており、有効ではない。フロー組み込みへの転換が必要。検討案:

1. wrap-up スキルの改善記録作成ステップに、サニタイズ検証を組み込む
2. lefthook の pre-commit で改善記録ファイルにカギ括弧付き引用がないかを lint する

具体的な対策は Issue #550 で検討する。

## 次のアクション

- [ ] Issue #550 の優先度を上げて対応する

## 分類

- カテゴリ: 参照漏れ
- 失敗タイプ: 実行ギャップ
- 問題の性質: プロセス的

# worktree セットアップでルート依存が未インストール

## 事象

worktree 環境で `just check-all` を実行したところ、`lint-openapi` ステップで `redocly` コマンドが見つからずに失敗した。

```
ERR_PNPM_RECURSIVE_EXEC_FIRST_FAIL  Command "redocly" not found
```

`@redocly/cli` はルートの `package.json` に定義されているが、worktree 環境では `pnpm install`（ルート）が実行されていなかった。

## 原因分析

### 表層的原因

worktree 環境でルートの `pnpm install` を実行していなかった。

### 根本原因

`setup-worktree` タスクに `setup-root-deps` が含まれていない。

```
setup:          check-tools setup-env setup-hooks dev-deps setup-db setup-root-deps setup-deps
setup-worktree:                                           dev-deps setup-db              setup-deps
```

`setup-worktree` は `setup` のサブセットとして設計されているが、ルートの依存関係（`@redocly/cli`, `jscpd`）のインストールが欠落している。

## 対策

`setup-worktree` に `setup-root-deps` を追加する。

| 対策形式 | 内容 | 評価 |
|---------|------|------|
| フロー組み込み | `setup-worktree` タスクに `setup-root-deps` を追加 | 高（自動化） |

Issue #512

## 分類

- カテゴリ: 視点不足
- 失敗タイプ: プロセスギャップ

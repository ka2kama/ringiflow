# コンテキストクリア後のワークフローステップ喪失

## 事象

`/start` → 計画作成 → コンテキストクリア → 実装、という流れで作業を進めた結果、Draft PR が作成されないまま実装・コミットが完了した。`/review-and-merge` 実行時に PR が存在しないことが発覚。

同種の問題の先行事例: [plan モード後のコンテキスト喪失による計画ファイルのコミット漏れ](2026-02-16_2301_planモード後のコンテキスト喪失による計画ファイルのコミット漏れ.md)

## 原因分析

### 直接原因

`/start` の実行後、計画作成フェーズでコンテキストクリアが行われ、Draft PR 作成ステップが実行されなかった。

### 根本原因

コンテキストクリアを跨ぐワークフローにおいて、後続ステップの実行が前のコンテキストに依存している。Draft PR 作成漏れは表面的な事象であり、本質的な問題は「`/start` が開始したワークフローの途中でコンテキストが切れ、残りのステップが実行されない」こと。計画ファイルのコミット漏れ（先行事例）と同じ構造的パターン。

## 対策

### 問題の性質: プロセス的

コンテキストクリア後に実行すべきステップが失われる構造的なフロー不備。

### 対策の方向性

| # | 方向性 | 内容 | 特徴 |
|---|-------|------|------|
| 1 | 個別チェック追加 | wrap-up や review-and-merge に個別の検証ステップを追加 | 漏れるたびにチェックを追加する必要がある（モグラ叩き的） |
| 2 | クリア前に完結 | `/start` が Draft PR 作成まで完了してから plan mode に入る | 根本原因を解消するが `/start` の設計変更が必要 |
| 3 | 復元時に自動検知 | `/start` のセッション再開時にブランチ状態から未完了ステップを検出 | 汎用的だが検出ロジックの設計が必要 |

方針は未決定。Issue #858 で検討する。

対策の Issue: #858

## 分類

- カテゴリ: 知識-実行乖離
- 失敗タイプ: プロセスギャップ
- 問題の性質: プロセス的
